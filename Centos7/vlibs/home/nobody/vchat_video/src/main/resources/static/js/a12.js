var name,mediaSource,analyser,ws=new WebSocket("wss://"+location.host+"/groupcall"),participants={},pcounter=0,real_pcnt=0,vcounter=0,i_am_guest=0,registered=0,guru_is_here=0,problems=0,suspected=0,altlang=["en","ru","es","fr","cn","pt"],waiting_period=633e3,logo_added=0,firstTime=!0,he_votado=!1,g={},playSomeMusic=!1,playSomeMusic_muted=!0,N=0;g.audioContext=new AudioContext,g.ctx=new AudioContext,g.video={},g.mixStream={},g.captureStreamVideoTrack={},g.captureStreamVideoTrack={};var only_once=1,shareSomeScreen=!1,already_being_played=!1,savedSrc=null,recordedVideo=null,now_playing=!1,__playing=!0,audio=null,audience_numberr=0,just_left="",connection_is_good=1,new_message=0,i_am_viewer=!0,i_am_dummy_guest=!1,nump=0,numv=0,num_cinemas=0,i_am_on_air=!1,saved_top="";const ua=navigator.userAgent.toLowerCase(),isAndroid=ua.indexOf("android")>-1,isSafari=/^((?!chrome|android).)*safari/i.test(navigator.userAgent),fps=15,wi=640,fps_hq=24,wi_hq=1280,sp_setter_url="https://coins2.room-house.com",sp_container_url="https://coins1.room-house.com",sm_url="https://slotmachine.room-house.com",poker_url="https://poker.room-house.com",chess_url="https://chess.room-house.com",air_url="https://bot.skypirl.net",swap_url="https://coins.room-house.com",small_device=!!((check_iOS()||isAndroid)&&screen.width<=1024||window!=window.top),tablet=!!(small_device&&screen.width>=960),notebook=screen.height<=800,controller=new AbortController,fetchTimeout=(e,t,{signal:n,...o}={})=>{const i=new AbortController,a=fetch(e,{signal:i.signal,...o});n&&n.addEventListener("abort",(()=>i.abort()));const r=setTimeout((()=>i.abort()),t);return a.finally((()=>clearTimeout(r)))};function visChanger(e){"visible"===document.visibilityState&&window.location.reload()}function visRejoiner(e){"visible"===document.visibilityState&&rejoin()}function rejoin(){already_being_played=!1,leaveRoom(),register()}function check_locked(e){0!=vcounter&&"0"!=vcounter||0!=pcounter&&"0"!=pcounter||cine||(console.log("locked!"),0==role&&function(){e&&clearAllCookies(),location.reload()}.delay(100))}window.onbeforeunload=function(){ws.close()},window.onload=function(){window.addEventListener("visibilitychange",visChanger),setInterval((function(){(registered&&!now_playing||problems)&&problems&&rejoin()}),5e3+1e4*Math.random()),setInterval((function(){(registered||problems)&&setTimeout((function(){check_connection()}),1e3)}),3e4+1e4*Math.random());let e=getCookie("loneGuy")||0;e&&void 0!==e&&(setCookie("loneGuy",0,1440),setTimeout((function(){document.getElementsByTagName("iframe")[0].contentDocument.getElementsByTagName("input")[5].click();let e=getCookie("playedFileName")||"";if(e.length){let n=document.id("room-header-file").files;for(var t=0;t<n.length;t++)if(n[t].name===e){selectedFile&&URL.revokeObjectURL(selectedFile),selectedFile=URL.createObjectURL(n[t]),curSelInd=t,curMovie=e;break}}else document.id("room-header-file").files&&document.id("room-header-file").files[0]&&(selectedFile=URL.createObjectURL(document.id("room-header-file").files[0]));setTimeout((function(){playSomeMusic=!0,cli6()}),2e3),setTimeout((function(){let e=getCookie("cinemaGuy")||0;console.log("here cinemaGuy is",e),e&&void 0!==e&&document.id("name")&&document.id("name").value&&document.id("one-"+document.id("name").value)&&(document.id("one-"+document.id("name").value).click(),console.log("clicked cinemaGuy"),setCookie("cinemaGuy",0,1440))}),7e3)}),1e3));let t=getCookie("lang");t=null===t||"null"===t?0:t,t=""===t?0:t,ctr=t,change_lang(altlang[ctr]),small_device||window!=window.top||(elements=Array.prototype.slice.call(document.getElementsByClassName("pricee")),elements.forEach((function(e){let t=buy_.get(altlang[ctr]);e.innerHTML=t})),elements=Array.prototype.slice.call(document.getElementsByClassName("gowee")),elements.forEach((function(e){let t=go_.get(altlang[ctr]);e.innerHTML=t}))),document.id("helplink").href=1==ctr?"https://github.com/kl3eo/room-house/blob/main/R-H_manual_RUS.pdf":"https://github.com/kl3eo/room-house/blob/main/R-H_manual_ENG.pdf";var n=getCookie("vote");he_votado=null===n||"null"===n?he_votado:n},ws.onmessage=function(e){var t=JSON.parse(e.data);switch(t.id){case"youLeft":rejoin();break;case"pingConn":problems=0,suspected=0,sendMessage({id:"replyPing"});break;case"existingParticipants":onExistingParticipants(t);break;case"existingViewers":onExistingViewers(t);break;case"newParticipantArrived":fullscreen||onNewParticipant(t);break;case"newViewerArrived":onNewViewer(t);break;case"participantLeft":onParticipantLeft(t);break;case"receiveVideoAnswer":receiveVideoResponse(t);break;case"changeTab":changeTabLR(t);break;case"bongoKey":bongoKey(t);break;case"clearCoo":clearTimeoutAndLeave();break;case"newDrop":newDrop(t);break;case"setGuru":setGuru(t);break;case"askGuru":askGuru(t);break;case"setCinema":setCinema(t);break;case"goodConnection":connection_is_good=1;break;case"roomConnection":nump=t.nump,numv=t.numv,function(){document.id("bstats")&&document.id("bstats").fade(1)}.delay(1e3);break;case"newChatMessage":newChatMessage();break;case"setAnno":setAnno(t);break;case"setMoviesList":setMoviesList(t);break;case"requestFilm":requestFilm(t);break;case"denyMovie":denyMovie(t);break;case"viewerLeft":just_left=t.name,onViewerLeft(just_left);break;case"iceCandidate":participants[t.name].rtcPeer.addIceCandidate(t.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}));break;default:console.error("Unrecognized message",t)}},isAndroid?screen.orientation.onchange=function(){document.id("viewer_menu")&&document.id("viewer_menu").setStyles({opacity:0,zIndex:0});let e=i_am_viewer&&1===vcounter&&cine?1:0,t=i_am_viewer&&1===vcounter&&cine?10111:0;document.id("viewer_menu")&&setTimeout((function(){window.innerWidth<window.innerHeight&&document.id("viewer_menu").setStyles({zIndex:t})&&document.id("viewer_menu").fade(e)}),1e3)}:check_iOS()&&(window.onorientationchange=function(){document.id("viewer_menu")&&document.id("viewer_menu").setStyles({opacity:0,zIndex:0});let e=i_am_viewer&&1===vcounter&&cine?1:0,t=i_am_viewer&&1===vcounter&&cine?10111:0;90===Math.abs(window.orientation)||document.id("viewer_menu")&&setTimeout((function(){document.id("viewer_menu").setStyles({zIndex:t}),document.id("viewer_menu").fade(e)}),1e3)});const check_connection=()=>{connection_is_good=0;sendMessage({id:"checkConnection"}),setTimeout((function(){if(connection_is_good)problems||0==pcounter&&role;else{if(suspected&&(problems=1),problems||(suspected=1),already_clicked=!1,playSomeMusic){setCookie("fmode",22,14400);let e="video-"+document.id("name").value;document.id(e)&&setCookie("cT_"+curMoviesList[0],document.id(e).currentTime,14400)}aonly=1,cammode=0,playSomeMusic=0,shareSomeScreen=0,console.log("resetting connection"),document.id("phones").innerHTML=warning,document.id("room_selector_box").style.zIndex=-1e4,function(){document.id("phones").fade(1)}.delay(1e3)}}),1200)},check_fullscreen_strict=()=>{request("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((e=>{fullscreen?(!e.length||window.screenTop||window.screenY||(window.innerWidth!=screen.width||window.innerHeight!=screen.height)&&isAndroid)&&(fullscreen=!1,!e.length&&cinemaEnabled?rejoin():fullscreen=!0):(window.innerWidth==screen.width&&window.innerHeight==screen.height||!window.screenTop&&!window.screenY||window.fullScreen)&&(e.length||rejoin())}))};function check_fullscreen(){request("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((e=>{fullscreen&&(!e.length||window.screenTop||window.screenY||(window.innerWidth!=screen.width||window.innerHeight!=screen.height)&&isAndroid)&&(fullscreen=!1,e.length?fullscreen=!0:rejoin())}))}function signalGuru(e){e.preventDefault(),e.stopPropagation();sendMessage({id:"signalGuru"})}function eventHandler(e){sendMessage({id:"keyDown",num:e})}function leftHandler(e){fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0;e.preventDefault(),e.stopPropagation();let o=parseInt(document.id("leftnum").innerHTML)+1;document.id("leftnum").innerHTML=o.toString(),sendMessage({id:"plus",s:"l",num:o}),1!=n&&(setCookie("vote",1,144e3),he_votado=!0)})).catch((e=>console.log(e)))}function noHandler(e){}function rightHandler(e){fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t||0;e.preventDefault(),e.stopPropagation();let o=parseInt(document.id("rightnum").innerHTML)+1;document.id("rightnum").innerHTML=o.toString(),sendMessage({id:"plus",s:"r",num:o}),he_votado=!0,1!=n&&(setCookie("vote",1,144e3),he_votado=!0)})).catch((e=>console.log(e)))}const register=()=>{document.id("house")&&(document.id("house").style.visibility="hidden"),document.id("room_name_id")&&(document.id("room_name_id").style.display="none"),document.id("preroom")&&(document.id("preroom").style.visibility="hidden"),getCookie("av")&&guru_is_here&&(aonly=0);window.innerWidth;aonly?(document.id("av_toggler")&&(document.id("av_toggler").className="bigO av_toggler"),document.id("bcam").className="bigO bcam",document.id("fcam").className="bigO fcam"):document.id("av_toggler")&&(document.id("av_toggler").className="bigO av_toggler_f"),ws.readyState===WebSocket.OPEN&&(problems=0,suspected=0),ws.readyState===WebSocket.CLOSED&&((ws=new WebSocket("wss://"+location.host+"/groupcall")).onmessage=function(e){var t=JSON.parse(e.data);switch(t.id){case"youLeft":rejoin();break;case"pingConn":problems=0,suspected=0,sendMessage({id:"replyPing"});break;case"existingParticipants":onExistingParticipants(t);break;case"existingViewers":onExistingViewers(t);break;case"newParticipantArrived":fullscreen||onNewParticipant(t);break;case"newViewerArrived":onNewViewer(t);break;case"participantLeft":onParticipantLeft(t);break;case"receiveVideoAnswer":receiveVideoResponse(t);break;case"changeTab":changeTabLR(t);break;case"bongoKey":bongoKey(t);break;case"clearCoo":clearTimeoutAndLeave();break;case"newDrop":newDrop(t);break;case"setGuru":setGuru(t);break;case"askGuru":askGuru(t);break;case"setCinema":setCinema(t);break;case"goodConnection":connection_is_good=1;break;case"roomConnection":nump=t.nump,numv=t.numv,function(){document.id("bstats")&&document.id("bstats").fade(1)}.delay(2e3);break;case"newChatMessage":newChatMessage();break;case"setAnno":setAnno(t);break;case"setMoviesList":setMoviesList(t);break;case"requestFilm":requestFilm(t);break;case"denyMovie":denyMovie(t);break;case"viewerLeft":just_left=t.name,onViewerLeft(just_left);break;case"iceCandidate":participants[t.name].rtcPeer.addIceCandidate(t.candidate,(function(e){e&&console.error("Error adding candidate: "+e)}));break;default:console.error("Unrecognized message",t)}}),name=document.id("name").value;let e=loadData("name");name.length||(name=e),name.length&&"null"!==name||saveData("name",name=(name=makeid(8))+"_"+name,1440);var t=new RegExp("GURU:","g");name.match(t)&&cine&&(saveData("name",name="GURU:"+(name=makeid(8))+"_"+name,1440),document.id("name").value=name),i_am_dummy_guest?fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((e=>{register_body(e||0),i_am_dummy_guest=!1})).catch((e=>console.log(e))):register_body(role)},register_body=e=>{var t=getCookie("player");let n=window.location.hostname.split("."),o=""==document.id("roomName").value?n[0]:document.id("roomName").value,i=n[0],a=document.id("curip").value;registered=1,window.removeEventListener("visibilitychange",visChanger),small_device&&window==window.top&&window.addEventListener("visibilitychange",visRejoiner);window.innerWidth;if(temporary&&0==e&&(role=3),-1==e)return soundEffect.src="/sounds/lock.mp3",setTimeout((function(){location.reload()}),1200),console.log("Knock out2"),!1;let r=checkLang();change_lang(altlang[r]),document.id("room-header").innerText="ROOM "+o,document.id("join").style.display="none",document.id("room").style.display="block",document.id("preroom").innerHTML="&nbsp;",document.id("postroom").style.display="none",function(){document.id("house").style.minHeight="0px",document.id("house").style.background="transparent",document.id("house").style.display="block",document.id("house").style.visibility="visible"}.delay(1e3),document.id("phones").style.display="block",document.id("phones").style.visibility="visible",document.id("cr").style.display="none",document.id("av_selector").style.display="block",document.id("poll").style.display="block",voting_shown&&(document.id("leftnum").style.display="block",document.id("rightnum").style.display="block");let s=getCookie("all_muted")||!1,d=loadData(document.id("name").value+"_muted");document.id("all_muter").className=check_iOS()&&!0!==d&&"true"!==d?"bigO my_mic_on_all_off":!0!==d&&"true"!==d||s||!role?s?"bigO allmuter_off":"bigO allmuter_on":"bigO my_mic_off",document.id("all_muter").title="bigO my_mic_on_all_off"===document.id("all_muter").className||"bigO allmuter_off"===document.id("all_muter").className?"Turn on sound":"bigO my_mic_off"===document.id("all_muter").className?"Turn on microphone":"Turn off sound",document.id("leftplus").style.display="block",document.id("rightplus").style.display="block",1!=e&&he_votado||!firstTime||(addEventListener("keydown",(e=>{let t=e.keyCode?e.keyCode:65;66===t&&("none"!==document.id("controls").style.display||small_device||(document.id("message_wrap").style.marginTop="48vh"),cli5()),eventHandler(t)})),firstTime=!1),document.id("fmode_selector").style.display="block",document.id("newsub").style.display="block",document.id("rh_container")&&(document.id("rh_container").style.display="none"),all_muted=getCookie("all_muted"),!0!==all_muted&&"true"!==all_muted&&!0!==d&&"true"!==d||(i_am_muted=!0);let c=!0===i_am_muted||"true"===i_am_muted?"m":aonly?"a":"v";c=t?"p":c;let l=getCookie("authtoken")||"";0==e&&hack&&(role=1);let u=new FormData;if(u.append("addr",a),fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{body:u,method:"post",credentials:"include"}).then((e=>e.text())).then((e=>{})).catch((e=>console.log(e))),request("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((e=>{let t={id:"joinRoom",name:name,mode:c,room:o,house:i,curip:a,acc_id:e,token:l,role:role,currRoom:currRoom};sendMessage(t)})),problems&&(document.id("phones").style.paddingTop=small_device?"39vh":"45vh",document.id("phones").style.lineHeight="36px",document.id("phones").innerHTML=warning,function(){document.id("phones").fade(1)}.delay(500)),stats_shown&&function(){document.id("stats").style.display="block",document.id("stats").fade(1)}.delay(1e3),!small_device&&document.id("helpdoc")&&function(){checkLang();small_device&&(document.id("helpdoc").style.paddingTop="0.4vh",document.id("helpdoc").style.paddingRight="2vw"),small_device||window==window.top||(document.id("helpdoc").style.marginRight="2vw"),document.id("helpdoc").fade(1)}.delay(500),small_device&&window!=window.top&&(document.id("message_wrap").style.marginLeft="-10px",document.id("message_wrap").style.width="330px",document.id("antichatter").style.marginLeft="290px"),document.body.style.overflowY="auto",function(){dummies=!0}.delay(3e3),document.body.scrollTop=document.documentElement.scrollTop=0,1==role&&!already_clicked&&problems){already_clicked=!0;let e=getCookie("fmode"),t=getCookie("av");(function(){if(0==e&&t&&(console.log("clicking 2!"),cli2()),1==e&&t&&(console.log("clicking 3!"),cli3()),22==e&&(playSomeMusic=!0,getFile(),cli6(),document.id("asender").value.length)){let e=document.id("asender").value.replace(/'/g,""),t=getCookie("authtoken"),n=0;const o=setInterval((function(){if(n++,sendMessage({id:"setAnno",anno:e,addr:document.id("name").value,token:t}),document.id("anno_"+document.id("name").value)||n>5){clearInterval(o);let e="video-"+document.id("name").value;document.id(e)&&(document.id(e).pause(),__playing=!1)}}),3e3)}console.log("auto re-connect, ca is",e,"av is",t)}).delay(200)}setTimeout((function(){check_locked(0)}),5e3)};function checkLang(){let e=getCookie("lang");return e=null===e||"null"===e?w[0].match(new RegExp("rgsu","g"))?1:0:""===e?0:e,e}const onNewViewer=e=>{if(e.currRoom&&currRoom!=e.currRoom)return!1;let t="video-"+document.id("name").value;(now_playing&&cinemaEnabled&&playSomeMusic&&e.accid.length||now_playing&&!cinemaEnabled&&playSomeMusic)&&function(){document.id(t)&&document.id(t).play(),__playing=!0}.delay(1e3),e.ng&&document.id("num_guests")&&(document.id("num_guests").innerHTML=e.ng),room_limit=void 0!==e.rl?e.rl:room_limit;let n=e.name.split("_"),o=n[0],i=n[n.length-1],a=e.name,r=e.curip;document.id("_au_"+i)&&document.id("_au_"+i).dispose();let s=temporary?"":"<span id=_o_"+i+" style=\"cursor:pointer;font-size:36px;border-radius:20px;\" onclick=\"if (this.style.background === '#9cf') {set_guru(3,'"+a+"');this.style.background='transparent';this.onclick=function(){set_guru(2,f);this.style.background='#9cf';}} else {set_guru(2,'"+a+"');this.style.background='#9cf';this.onclick=function(){set_guru(3,'"+a+"');this.style.background='transparent';}}\">O</span> ",d="Audience is empty :("==document.id("audience_boxx").innerHTML?"":document.id("audience_boxx").innerHTML;d="<div id=_au_"+i+">"+s+"<span id=au_"+i+' style="color:#9cf;cursor:pointer;" onclick="set_guru(1,\''+a+"');\">"+o+"</span>, "+r+' <span style="cursor:pointer;"  onclick="drop_guest(\''+a+"')\" >X</span></div>"+d,document.id("audience_boxx").innerHTML=d;let c=d.split("_au_").length-1;document.id("audience_numbers").innerHTML=c;let l=c>0?"#369":"#ccc";document.id("audience_numbers").setStyles({color:l}),vcounter=c,document.id("vcounter")&&(document.id("vcounter").innerHTML=vcounter);let u=i_am_viewer&&1===vcounter&&cine?1:0,m=i_am_viewer&&1===vcounter&&cine?10111:0;document.id("viewer_menu")&&!lori&&setTimeout((function(){document.id("viewer_menu").setStyles({zIndex:m}),document.id("viewer_menu").fade(u)}),1e3),just_left!=a&&document.id("name").value!=a&&document.id("name").value!=just_left&&(cine?soundEffect.src="/sounds/coin.mp3":soundEffect.src="/sounds/steps.mp3")},onNewParticipant=e=>{if(e.currRoom&&currRoom!=e.currRoom)return!1;e.ng&&document.id("num_guests")&&(document.id("num_guests").innerHTML=e.ng);let t=role,n="video-"+document.id("name").value;now_playing&&function(){document.id(n).play(),__playing=!0}.delay(3e3);var o=document.cookie.split(";"),i=1,a=0;room_limit=void 0!==e.rl?e.rl:room_limit;for(var r=1;r<=o.length;r++){if(o[r-1].match(e.name+"_hidden")){a=1,i=0;break}if(!a){var s=localStorage.getItem(e.name+"_muted");if(o[r-1].match(e.name+"_muted")||null!==s&&"null"!==s){i=0;break}}}i&&(soundEffect.src="/sounds/coin.mp3");let d=loadData(document.id("name").value+"_muted");if(document.id("all_muter").className=check_iOS()&&!0!==d&&"true"!==d?"bigO my_mic_on_all_off":document.id("all_muter").className,!a){let n=pcounter+1;n>room_limit-1&&i_am_viewer&&(document.id("bell")&&(document.id("bell").style.display="block"),document.id("av_toggler")&&(document.id("av_toggler").style.display="none")),small_device||window!=window.top||resizer(n),(small_device||tablet)&&(document.id("participants").style.marginTop="-68vh",small_device&&0===pcounter&&(document.id("participants").style.height=window==window.top?"50vh":"63vh"),small_device&&1===pcounter&&(document.id("participants").style.height=window==window.top?"110vh":tablet?"140vh":"128vh"),small_device&&2===pcounter&&(document.id("participants").style.height=window==window.top?"160vh":"190vh"),small_device&&3===pcounter&&(document.id("participants").style.height=window==window.top?"220vh":"250vh"),small_device&&pcounter>3&&(document.id("participants").style.height=window==window.top?"275vh":"300vh")),receiveVideo(e.name,e.mode,t,!0),function(){document.id(e.name)&&(document.id(e.name).style.display="block",document.id(e.name).fade(1))}.delay(500);let o="bigO my_mic_on_all_off"===document.id("all_muter").className||"bigO allmuter_off"===document.id("all_muter").className,i=document.id("video-"+e.name);i.muted=o,cine&&(i.muted=!0),"m"===e.mode&&(i.muted=!0);let a=document.id("speaker-"+e.name);if(a.removeChild(a.childNodes[0]),"m"!==e.mode&&(o||cine)&&a.appendChild(document.createTextNode("🔇")),"m"!==e.mode&&!o&&!cine&&a.appendChild(document.createTextNode("🔊")),"m"===e.mode&&a.appendChild(document.createTextNode("X")),e.curip.length&&document.id("loco_"+e.name)&&!ValidateIPaddress(e.curip)&&(document.id("loco_"+e.name).innerHTML=e.curip,document.id("loco_"+e.name).style.display="block",document.id("loco_"+e.name).fade(1)),cine&&1!=role&&function(){document.id("loco_"+e.name).fade(0),document.id("span_"+e.name).fade(0)}.delay(2e3),document.id("acco_"+e.name)&&ValidateAccountId(e.acc_id)){document.id("acco_"+e.name).style.display="block";let t=e.name.split("_"),n=e.acc_id;document.id("acco_"+e.name).fade(1),document.id("acco_"+e.name).onclick=function(o){o.preventDefault(),o.stopPropagation(),copy(n),flashText("copied "+t[0]),e("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((e=>{setTimeout((function(){document.id("removerA")&&(document.id("removerA").innerHTML="Error: Service unavailable",function(){document.id("removerA").fade(0)}.delay(1e3))}),1e4),function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+e)}.delay(1e3),document.id("sp_container").style.display="block",sp_shown=1,ch_int=setInterval((function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+e)}),3e5)}))},document.id(sp_shown)&&"block"!=document.id("sp_container").style.display&&(document.id("acco_"+e.name).style.visibility="hidden")}}let c=i_am_viewer&&1===vcounter&&cine&&("p"==e.mode||"c"==e.mode)?1:0,l=i_am_viewer&&1===vcounter&&cine?10111:0;document.id("viewer_menu")&&!lori&&setTimeout((function(){document.id("viewer_menu").setStyles({zIndex:l}),document.id("viewer_menu").fade(c)}),1e3)};function receiveVideoResponse(e){participants[e.name].rtcPeer.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))}function callResponse(e){"accepted"!=e.response?(console.info("Call not accepted by peer. Closing call"),stop()):webRtcPeer.processAnswer(e.sdpAnswer,(function(e){if(e)return console.error(e)}))}async function startCapture(e){let t=null;try{t=await navigator.mediaDevices.getDisplayMedia(e)}catch(e){console.error("Error: "+e)}return t}const onExistingViewers=e=>{let t=document.id("name").value,n="",o=t!=just_left;if(e.ng&&document.id("num_guests")&&(document.id("num_guests").innerHTML=e.ng),room_limit=void 0!==e.rl?e.rl:room_limit,e.data){for(var i=e.data.sort(),a=0;a<i.length;a++){var r=i[a].split("_|_");let e=r[0],d=r[1];e==just_left&&(just_left="",o=!1);let c=e.split("_"),l=c[0],u=c[c.length-1];if(e==t){o=!1;var s=getCookie("lang");if(d.length&&(null===s||"null"===s)){let e=/, AR$/.test(d),t=/, BR$/.test(d),n=/, RU$/.test(d);e?ctr=2:t?ctr=5:n&&(ctr=1),change_lang(altlang[ctr])}}document.id("_au_"+u)&&document.id("_au_"+u).dispose(),n=n+"<div id=_au_"+u+">"+(temporary?"":"<span id=_o_"+u+" style=\"cursor:pointer;font-size:36px;border-radius:20px;\" onclick=\"if (this.style.background === '#9cf') {set_guru(3,'"+e+"');this.style.background='transparent';this.onclick=function(){set_guru(2,f);this.style.background='#9cf';}} else {set_guru(2,'"+e+"');this.style.background='#9cf';this.onclick=function(){set_guru(3,'"+e+"');this.style.background='transparent';}}\">O</span> ")+"<span id=au_"+u+' style="color:#9cf;cursor:pointer;" onclick="set_guru(1,\''+e+"');\">"+l+"</span>, "+d+' <span style="cursor:pointer;" onclick="drop_guest(\''+e+"')\" >X</span></div>"}0==i.length?(n="Audience is empty :(",document.id("audience_numbers").setStyles({color:"#ccc"}),document.id("audience_numbers").innerHTML="...",audience_numberr=0,vcounter=0,document.id("vcounter")&&function(){document.id("vcounter").innerHTML=vcounter}.delay(500)):(document.id("audience_numbers").setStyles({color:"#369"}),document.id("audience_numbers").innerHTML=i.length,i.length>audience_numberr&&i.length>0&&o&&(soundEffect.src="/sounds/steps.mp3"),audience_numberr=i.length,vcounter=i.length,document.id("vcounter")&&(document.id("vcounter").innerHTML=vcounter)),document.id("audience_boxx")&&(document.id("audience_boxx").innerHTML=n)}let d=i_am_viewer&&1===vcounter&&cine?1:0,c=i_am_viewer&&1===vcounter&&cine?10111:0;document.id("viewer_menu")&&!lori&&setTimeout((function(){document.id("viewer_menu").setStyles({zIndex:c}),document.id("viewer_menu").fade(d)}),1e3)},set_guru=(e,t)=>{fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((n=>{if(1==(n||0)){let n=getCookie("authtoken")||"";sendMessage({id:"setGuru",name:t,mode:e,token:n})}else document.id("name").value==t&&(chat_shown=1,document.id("logger").click(),document.id("audience").click(),rejoin())})).catch((e=>console.log(e)))};function drop_guest(e){fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{if(1==(t||0)){let t=getCookie("authtoken")||"";sendMessage({id:"dropGuest",name:e,token:t})}else onViewerLeft(e);let n=e.split("_");document.id("_au_"+n[1])&&document.id("_au_"+n[1]).dispose()})).catch((e=>console.log(e)))}const onExistingParticipants=e=>{let t=document.id("name").value;0==role&&hack&&(role=1),e.num_rooms&&(num_rooms=e.num_rooms);let n="";var o="A";for(h=1;h<=num_rooms;h++){n+=(o=2==h?"B":3==h?"C":4==h?"D":5==h?"E":6==h?"F":o)==currRoom?'&nbsp;&nbsp;<span style="color:#fed;border:0px solid #fed; padding:3px">ROOM'+h+"</span>&nbsp;&nbsp;":'&nbsp;&nbsp;<span style="color:#9cf;cursor:pointer; padding:3px" onclick="currRoom = \''+o+"';/*console.log('sym',currRoom);*/(function(){document.id('bg_switch').click()}).delay(500);flashText_and_rejoin('SKIP TO ROOM ' + currRoom);\">ROOM"+h+"</span>&nbsp;&nbsp;"}if(1==num_rooms&&(n=""),num_rooms<4&&(document.id("room_selector_box").style.left="-10px"),4===num_rooms&&(document.id("room_selector_box").style.left="-25px"),5===num_rooms&&(document.id("room_selector_box").style.left="-80px"),num_rooms>5&&(document.id("room_selector_box").style.left="-135px"),document.id("room_selector").innerHTML=n,temporary&&0==role&&(role=3),1==role||2==role||3==role){let e=getCookie("fmode")?"environment":"user";i_am_viewer=!1,all_muted=getCookie("all_muted"),!0!==all_muted&&"true"!==all_muted||(i_am_muted=!0);let n=!0===i_am_muted||"true"===i_am_muted?"m":aonly?"a":"v";var i=new Participant(name,t,n,role,!1);participants[name]=i,g.video=recordedVideo||i.getVideoElement();var a=check_iOS()?i.getCanvasElement():"",r={audio:!0,video:{maxWidth:1280,maxFrameRate:24,minFrameRate:24,facingMode:e}},s={audio:!1,video:{facingMode:e}},d={audio:!0,video:!1},c={audio:!1,video:!1};aonly&&(r=d);var l=!0===i_am_muted||"true"===i_am_muted||3===role?s:d;r=!0!==i_am_muted&&"true"!==i_am_muted||!aonly?!0===i_am_muted||"true"===i_am_muted?s:r:c,l=!0!==i_am_muted&&"true"!==i_am_muted||!aonly?!0===i_am_muted||"true"===i_am_muted?s:l:c;var u={localVideo:g.video,mediaConstraints:r,onicecandidate:i.onIceCandidate.bind(i)},m={localVideo:g.video,mediaConstraints:l,onicecandidate:i.onIceCandidate.bind(i)};if(recordedVideo&&savedSrc){shareSomeStream=!0;var p={audio:!0,video:{maxWidth:wi,maxFrameRate:15,minFrameRate:15}};u={videoStream:savedSrc,onicecandidate:i.onIceCandidate.bind(i),mediaConstraints:p},option_alt={videoStream:savedSrc,onicecandidate:i.onIceCandidate.bind(i),mediaConstraints:{audio:!0,video:!1}},i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(u,(function(e){if(e){var n=new RegExp("closed","ig");return e.toString().match(n)||(i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(option_alt,(function(e){if(e)return console.error(e);startVideo(g.video),this.generateOffer(i.offerToReceiveVideo.bind(i)),small_device&&(document.id(t).style.float="none"),document.id("room-header-file").style.display="none"}))),!1}startVideo(g.video),this.generateOffer(i.offerToReceiveVideo.bind(i)),small_device&&(document.id(t).style.float="none"),document.id("room-header-file").style.display="none",function(){document.id("phones").fade(0)}.delay(1e3)}))}else if(shareSomeScreen)shareSomeScreen=!0,document.id("room-header").style.color=oldColor,startCapture({video:!0}).then((e=>{navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){var o=n.getAudioTracks()[0]?n.getAudioTracks()[0]:null;o&&!0!==i_am_muted&&"true"!==i_am_muted&&e.addTrack(o),g.video.srcObject=e;var a={videoStream:e,onicecandidate:i.onIceCandidate.bind(i),mediaConstraints:{audio:!0,video:{maxWidth:1280,maxFrameRate:24,minFrameRate:24}},sendSource:"screen"};i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(a,(function(e){if(e){var n=new RegExp("closed","ig");return e.toString().match(n)||(i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(m,(function(e){if(e)return console.error(e);startVideo(g.video),this.generateOffer(i.offerToReceiveVideo.bind(i)),small_device&&(document.id(t).style.float="none")}))),!1}startVideo(g.video),this.generateOffer(i.offerToReceiveVideo.bind(i)),small_device&&(document.id(t).style.float="none"),function(){document.id("phones").fade(0)}.delay(1e3)}))})).catch((function(e){console.log(e.name+": "+e.message)}))})).catch((e=>console.log(e)));else if(playSomeMusic){!1===playSomeMusic_muted&&(g.audioContext||(g.audioContext=new AudioContext),mediaSource=g.audioContext.createMediaElementSource(g.video),analyser=g.audioContext.createAnalyser(),mediaSource.connect(analyser),analyser.connect(g.audioContext.destination)),g.video.autoplay=!0,g.video.playsInline=!0,g.video.controls=!0,g.video.crossOrigin="anonymous",g.video.volume=1,g.video.loop=!0,g.video.src=selectedFile||null,g.video.muted=!1;let e=curMovie?getCookie("cT_"+curMovie):0;g.video.currentTime=e>0?e:0,g.video.addEventListener("canplay",(e=>{if(now_playing=!0,!already_being_played){console.log("running",N++),already_being_played=!0;let e=null;navigator.mediaDevices.getUserMedia({audio:!0}).then((function(n){var o=n.getAudioTracks()[0]?n.getAudioTracks()[0]:null;a.captureStream?(e=a.captureStream(24),o&&!0!==i_am_muted&&"true"!==i_am_muted&&e.addTrack(o)):g.video.captureStream?e=g.video.captureStream(24):g.video.mozCaptureStream?e=g.video.mozCaptureStream(24):console.error("Stream capture is not supported");let r=null;if(!cine){console.log("doing mic mix in normal mode"),g.ctx||(g.ctx=new AudioContext);const t=g.ctx.createMediaStreamDestination(),i=o?g.ctx.createMediaStreamSource(n):null,a=e.getAudioTracks()[0]?g.ctx.createMediaStreamSource(e):null;!0!==i_am_muted&&"true"!==i_am_muted&&i&&i.connect(t),a&&a.connect(t),r=t.stream.getAudioTracks()[0]?t.stream.getAudioTracks()[0]:null}g.captureStreamVideoTrack=e.getVideoTracks()[0]?e.getVideoTracks()[0]:null,g.captureStreamAudioTrack=e.getAudioTracks()[0]?e.getAudioTracks()[0]:null,g.mixStream=new MediaStream,g.captureStreamVideoTrack&&g.mixStream.addTrack(g.captureStreamVideoTrack),!cine&&r&&g.mixStream.addTrack(r),cine&&g.captureStreamAudioTrack&&g.mixStream.addTrack(g.captureStreamAudioTrack);var s={audio:!0,video:{maxWidth:1280,maxFrameRate:24,minFrameRate:24}};u={videoStream:g.mixStream,onicecandidate:i.onIceCandidate.bind(i),mediaConstraints:s},option_alt={videoStream:g.mixStream,onicecandidate:i.onIceCandidate.bind(i),mediaConstraints:{audio:!0,video:!1}},i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(u,(function(e){if(e){var n=new RegExp("closed","ig");return e.toString().match(n)||(i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(option_alt,(function(e){if(e)return console.error(e);startVideo(g.video),this.generateOffer(i.offerToReceiveVideo.bind(i)),small_device&&(document.id(t).style.float="none"),document.id("room-header-file").style.display="none"}))),!1}if(g.video.play(),!1===playSomeMusic_muted);this.generateOffer(i.offerToReceiveVideo.bind(i)),small_device&&(document.id(t).style.float="none"),document.id("room-header-file").style.display="none",function(){document.id("phones").fade(0)}.delay(1e3),shareSomeStream||getList_names()}))})).catch((function(e){console.log(e.name+": "+e.message)}))}}))}else i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(u,(function(e){if(e){var n=new RegExp("closed","ig");return e.toString().match(n)||(i.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerSendonly(u,(function(e){if(e)return console.error(e);startVideo(g.video),this.generateOffer(i.offerToReceiveVideo.bind(i)),small_device&&(document.id(t).style.float="none")}))),!1}startVideo(g.video),this.generateOffer(i.offerToReceiveVideo.bind(i)),i_am_on_air=!0,(small_device||tablet)&&(document.id("participants").style.marginTop=isIOSFirefox()?"-46vh":"-55vh",1===pcounter&&(document.id("participants").style.height=window==window.top?"50vh":"63vh"),2===pcounter&&(document.id("participants").style.height=window==window.top?"110vh":tablet?"140vh":"128vh"),3===pcounter&&(document.id("participants").style.height=window==window.top?"160vh":"190vh"),4===pcounter&&(document.id("participants").style.height=window==window.top?"220vh":"250vh"),pcounter>4&&(document.id("participants").style.height=window==window.top?"275vh":"300vh"),document.id(t).style.position="absolute",document.id(t).style.bottom="0vh",pcounter>1?(document.id("participants").style.position="absolute",saved_top=document.id("participants").style.top,document.id("participants").style.top="81vh"):(document.id("participants").style.position="relative",document.id("participants").style.top=saved_top.length?saved_top:document.id("participants").style.top)),small_device||window!=window.top||resizer(1),function(){document.id("phones").fade(0)}.delay(1e3)}));(function(){document.id(t).style.display="block",document.id(t).fade(1)}).delay(500)}if(e.data){cinemaEnabled=!1,num_cinemas=0;for(var h=0;h<e.data.length;h++){var f=e.data[h].split("_|_");let n=f[0],o=f[1],i=f[2],a=f[3],r=f[4],s=f[0].split("_");if("c"===o&&(cinemaEnabled=!0,num_cinemas+=1),n!=t){let e=pcounter+1;e<room_limit&&0==role&&(document.id("bell").style.display="none",document.id("av_toggler").style.display="block"),e>room_limit-1&&0==role&&(document.id("bell").style.display="block",document.id("av_toggler").style.display="none"),small_device||resizer(e),receiveVideo(n,o,role,!1);let t=loadData(n+"_volume");document.id("slider_"+n)&&(document.id("slider_"+n).value=t),document.id("video-"+n)&&(document.id("video-"+n).volume=t),function(){document.id(n)&&(document.id(n).style.display="block",document.id(n).fade(1))}.delay(500)}else{var v=getCookie("lang");if(i.length&&(null===v||"null"===v)){let e=/, AR$/.test(i),t=/, BR$/.test(i),n=/, RU$/.test(i);e?ctr=2:t?ctr=5:n&&(ctr=1),change_lang(altlang[ctr])}}if(i.length&&document.id("loco_"+n)&&!ValidateIPaddress(i)&&(document.id("loco_"+n).innerHTML=i,document.id("loco_"+n).style.display="block",document.id("loco_"+n).fade(1)),cine&&function(){document.id("loco_"+n)&&document.id("loco_"+n).fade(0),document.id("span_"+n)&&document.id("span_"+n).fade(0)}.delay(2e3),document.id("acco_"+n)&&ValidateAccountId(a)&&(document.id("acco_"+n).style.display="block",document.id("acco_"+n).fade(1),document.id("acco_"+n).onclick=function(){copy(a),flashText("copied "+s[0]),request("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((e=>{setTimeout((function(){document.id("removerA")&&(document.id("removerA").innerHTML="Error: Service unavailable",function(){document.id("removerA").fade(0)}.delay(1e3))}),1e4),function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+e)}.delay(1e3),document.id("sp_container").style.display="block",sp_shown=1,ch_int=setInterval((function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+e)}),3e5)}))},document.id(sp_shown)&&"block"!=document.id("sp_container").style.display&&(document.id("acco_"+n).style.visibility="hidden")),document.id("anno_"+n)){let e=r.split("@#%");if(2==e.length){document.id("anno_"+n).innerHTML="<select id='selector_"+n+"' onchange='handleFileSelectChange(this.options[this.selectedIndex].text)' onmouseover='toggleOpacity(this.parentNode)' onmouseout='toggleOpacity(this.parentNode)'></select>";let t=e[1]||0,o=[];o=e[0].substring(2,e[0].length-2).split('","');let i=o[curSelInd=t];o.splice(curSelInd,1),o.unshift(i),curMovie=o[0];let a=document.id("selector_"+n).options,r=cinemaEnabled?1:o.length;for(h=0;h<r;h++)a.add(new Option(o[h],h))}else document.id("anno_"+n)&&(document.id("anno_"+n).innerHTML=r);r&&r.length&&(document.id("anno_"+n).style.display="block",document.id("anno_"+n).fade(1)),"c"===o&&setTimeout((function(){document.id("anno_"+n)&&document.id("anno_"+n).fade(.02)}),2e3),setTimeout((function(){document.id("one-"+n)&&document.id("one-"+n).fade(.5)}),3e3),document.id("room-header").fade(0)}}(small_device||tablet)&&(document.id("participants").style.marginTop="-68vh",2===pcounter&&(document.id("participants").style.height=window==window.top?"110vh":tablet?"140vh":"128vh"),3===pcounter&&(document.id("participants").style.height=window==window.top?"160vh":"190vh"),4===pcounter&&(document.id("participants").style.height=window==window.top?"220vh":"250vh"),pcounter>4&&(document.id("participants").style.height=window==window.top?"275vh":"300vh"))}request("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((e=>{0==role&&cinemaEnabled&&!e.length?document.id("sp_balance")&&document.id("sp_container")&&(setTimeout((function(){document.id("sp_container").style.display="block"}),2e3),setTimeout((function(){document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="}),1e3)):(document.id("sp_container").style.display="none",document.id("sp_balance").style.display="none")}))};function copy(e){var t=document.createElement("input");document.body.appendChild(t),t.value=e,t.select(),document.execCommand("copy",!1),t.remove()}const grun=()=>{recordedVideo=document.querySelector("video"),savedSrc=recordedVideo.mozCaptureStream?recordedVideo.mozCaptureStream(15):recordedVideo.captureStream?recordedVideo.captureStream(15):null,recordedVideo.muted=!1,rejoin()},leaveRoom=()=>{document.id("name").value;if(Object.keys(participants).length)for(var e in participants)participants[e].dispose(),delete participants[e].rtcPeer,delete participants[e];delete g.mixStream,delete g.video,delete g.captureStreamVideoTrack,delete g.captureStreamAudioTrack,pcounter=0,vcounter=0,i_am_guest=0,registered=0,document.id("num_quests")&&(document.id("num_quests").innerHTML=0),document.id("vcounter")&&(document.id("vcounter").innerHTML=vcounter),sendMessage({id:"leaveRoom"}),just_left=document.id("name").value},receiveVideo=(e,t,n,o)=>{let i=!0===o;var a=new Participant(e,document.id("name").value,t,n,i);participants[e]=a,g.video=a.getVideoElement();var r={audio:!0,video:{maxWidth:1280,maxFrameRate:24,minFrameRate:24}},s={remoteVideo:g.video,mediaConstraints:r,onicecandidate:a.onIceCandidate.bind(a)},d={remoteVideo:g.video,mediaConstraints:{audio:!0,video:!1},onicecandidate:a.onIceCandidate.bind(a)};s="a"===t?d:s,a.rtcPeer=new kurentoUtils.WebRtcPeer.WebRtcPeerRecvonly(s,(function(t){if(t)return console.error(t);startVideo(g.video),this.generateOffer(a.offerToReceiveVideo.bind(a)),small_device&&(document.id(e).style.float="none",document.id(e).className=PARTICIPANT_MAIN_CLASS)}))},newDrop=e=>{let t=e.user.split("_"),n=(t[0],t[t.length-1]);document.id("_o_"+n)&&(document.id("_o_"+n).style.background="transparent")},setGuru=e=>{window.innerWidth;"2"==e.mode&&1!=role&&(document.body.style.background="#FFD580",soundEffect.src="/sounds/buzz.mp3",soundEffect.src="/sounds/please_receive_airdrop.mp3",flashText('push "b", then "+" and paste your Substrate address to "WRITE TO CHAT"',5e3)),"3"==e.mode&&1!=role&&(document.body.style.background="#112",soundEffect.src="/sounds/track01.mp3"),"1"==e.mode&&1!=role&&(setCookie("av",!0,144e3),aonly=0,soundEffect.src="/sounds/please_allow_camera.mp3",temporary=1,chat_shown=1,document.id("logger").click(),document.id("audience").click(),rejoin(),document.id("av_toggler").style.display="block",document.id("bell").style.display="none"),"0"==e.mode&&temporary&&(role=0,temporary=0,chat_shown=1,document.id("logger").click(),document.id("audience").click(),cammode=0,document.id("fcam").className="bigO fcam",document.id("bcam").className="bigO bcam",setCookie("av",!1,144e3),aonly=1,document.id("av_toggler").style.display="none",document.id("bell").style.display="block",document.id("room").style.marginTop="37px",hack=!1,i_am_viewer=!0,flashText_and_rejoin("AUDIO-ONLY"))};function askGuru(e){let t=e.name.split("_"),n=t[0],o=t[t.length-1];document.id("_au_"+o)&&document.id("_au_"+o).dispose();let i=temporary?"":"<span id=_o_"+o+" style=\"cursor:pointer;font-size:36px;border-radius:20px;\" onclick=\"if (this.style.background === '#9cf') {set_guru(3,'"+e.name+"');this.style.background='transparent';this.onclick=function(){set_guru(2,'"+e.name+"');this.style.background='#9cf';}} else {set_guru(2,'"+e.name+"');this.style.background='#9cf';this.onclick=function(){set_guru(3,'"+e.name+"');this.style.background='transparent';}}\">O</span> ",a="Audience is empty :("==document.id("audience_boxx").innerHTML?"":document.id("audience_boxx").innerHTML;a="<div id=_au_"+o+">"+i+"<span id=au_"+o+' style="color:#9cf;cursor:pointer;font-size:16px;font-weight:bold;" onclick="set_guru(1,\''+e.name+"');\">"+n+"</span> "+requ+' <span style="cursor:pointer;" onclick="drop_guest(\''+e.name+"')\" >X</span></div>"+a;a.split("_au_").length;document.id("audience_boxx").innerHTML=a,document.id("au_"+o).setStyles({color:"#faa"}),soundEffect.src="/sounds/wood_"+window.location.hostname+port+".mp3",chat_shown=0,document.id("logger").click(),document.id("message_box").style.display="none",document.id("audience_box").style.display="table"}const setCinema=e=>{let t=document.id("name").value;fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((n=>{let o=n||0,i=e.mode;if("c"==i&&e.name!==t)return void rejoin();let a=participants[e.name];if(!a)return void rejoin();a.setMode(e.mode);let r=document.id("one-"+e.name);r&&(r.style.color="c"==i?"#ff0":"#369",r.style.fontWeight="c"==i?"bold":"normal",r.style.display="c"==i||1==o?"block":"none",r.innerHTML="c"==i?"CINEMA!":"CINEMA?"),num_cinemas="c"==i?num_cinemas+1:num_cinemas-1,cinemaEnabled="c"==i||!!num_cinemas&&cinemaEnabled})).catch((e=>console.log(e)))};function newChatMessage(){new_message=1;let e=setInterval((function(){new_message?document.id("logger").className="bigO logger_g":(document.id("logger").className=chat_shown?"bigO logger_f":"bigO logger",clearInterval(e))}),1e3);fetch("https://"+window.location.hostname+port+"/log.html").then((e=>e.text())).then((e=>{document.id("message_box").innerHTML=e})).catch((e=>console.log(e))),soundEffect.src="/sounds/buzz.mp3"}function setAnno(e){let t=e.anno.split("@#%");if(2==t.length){document.id("anno_"+e.participant).innerHTML="<select id='selector_"+e.participant+"' onchange='handleFileSelectChange(this.options[this.selectedIndex].text)' onmouseover='toggleOpacity(this.parentNode)' onmouseout='toggleOpacity(this.parentNode)'></select>";let n=t[1]||0,o=[];o=t[0].substring(2,t[0].length-2).split('","');let a=t[curSelInd=n];o.splice(curSelInd,1),o.unshift(a),curMovie=o[0];let r=document.id("selector_"+e.participant).options;for(i=0;i<o.length;i++)r.add(new Option(o[i],i))}else document.id("anno_"+e.participant)&&(document.id("anno_"+e.participant).innerHTML=e.anno);document.id("anno_"+e.participant).style.display="block",document.id("anno_"+e.participant).fade(1),document.id("room-header").fade(0)}function handleFileSelectChange(e){if(null==e||0===e.length)return;let t=document.id("room-header-file").files;for(var n=0;n<t.length;n++)if(t[n].name===e){selectedFile&&URL.revokeObjectURL(selectedFile),selectedFile=URL.createObjectURL(t[n]),setCookie("cT_"+curMoviesList[0],document.id("video-"+document.id("name").value).currentTime,14400),curSelInd=n,curMovie=e,rejoin();break}if(0==t.length){sendMessage({id:"requestMovie",name:e})}}function toggleOpacity(e){let t=.02==e.style.opacity?1:.02;e.fade(t)}function setMoviesList(e){if(document.id("anno_"+e.participant)){document.id("anno_"+e.participant).innerHTML="<select id='selector_"+e.participant+"' onchange='handleFileSelectChange(this.options[this.selectedIndex].text)' onmouseover='toggleOpacity(this.parentNode)' onmouseout='toggleOpacity(this.parentNode)'></select>";let t=[];t=e.ml.substring(2,e.ml.length-2).split('","');let n=t[curSelInd=e.cs];t.splice(curSelInd,1),t.unshift(n),curMovie=t[0];let o=document.id("selector_"+e.participant)?document.id("selector_"+e.participant).options:[];for(curMoviesList=[],i=0;i<t.length;i++)o.add(new Option(t[i],i)),curMoviesList.push(t[i]);document.id("anno_"+e.participant).style.display="block",document.id("anno_"+e.participant).fade(1),setTimeout((function(){document.id("anno_"+e.participant)&&document.id("anno_"+e.participant).fade(.02)}),2e3),document.id("room-header").fade(0),document.id("room-header-file").style.display="none"}}function requestFilm(e){handleFileSelectChange(e.name)}function denyMovie(e){flashText("Currently "+e.n+" people watching!")}function changeTabLR(e){"l"==e.side&&(document.id("leftnum")&&(document.id("leftnum").innerHTML=e.num.toString()),soundEffect.src="/sounds/track04.mp3"),"r"==e.side&&(document.id("rightnum")&&(document.id("rightnum").innerHTML=e.num.toString()),soundEffect.src="/sounds/track01.mp3")}function bongoKey(e){let t="",n="video-"+document.id("name").value;"66"==e.num&&(soundEffect.src="/sounds/track02.mp3",t="b",now_playing&&(document.id(n).currentTime=0,document.id(n).play(),__playing=!0)),"67"==e.num&&(t="c",now_playing&&(document.id(n).currentTime=0,document.id(n).play(),__playing=!0)),"68"==e.num&&(t="d",now_playing&&(document.id(n).currentTime+=300,document.id(n).play(),__playing=!0)),"70"==e.num&&(t="f",now_playing&&(document.id(n).currentTime+=10,document.id(n).play(),__playing=!0)),"80"==e.num&&(t="p",now_playing&&(document.id(n).play(),__playing=!0)),"82"==e.num&&(t="r",now_playing&&(document.id(n).currentTime-=10,document.id(n).play(),__playing=!0)),"83"==e.num&&(t="s",now_playing&&(document.id(n).pause(),__playing=!1)),"84"==e.num&&(t="t",playSomeMusic&&selectedFile&&cine&&(setCookie("loneGuy",!0,1),setCookie("playedFileName",curMoviesList[0]),setCookie("cT_"+curMoviesList[0],document.id("video-"+document.id("name").value).currentTime,14400),"rgb(255, 255, 0)"==document.id("one-"+document.id("name").value).style.color&&setCookie("cinemaGuy",!0,10),location.reload())),"85"==e.num&&(t="u",now_playing&&__playing?(document.id(n).pause(),__playing=!1):now_playing&&!__playing&&(document.id(n).play(),__playing=!0)),document.id("leftbongo")&&(document.id("leftbongo").innerHTML=t,document.id("leftbongo").fade(1),function(){document.id("leftbongo").fade(0)}.delay(300))}function clearTimeoutAndLeave(){1!=role&&(eraseCookie("timeout_nc"),soundEffect.src="/sounds/drop.mp3",document.id("phones").innerHTML="Leaving room",document.id("phones").fade(1),setTimeout((function(){location.reload()}),1e3))}const onParticipantLeft=e=>{var t=participants[e.name];if(t)participants[e.name].dispose(),delete participants[e.name].rtcPeer,delete participants[e.name],pcounter<room_limit&&(document.id("bell").style.display="none",document.id("av_toggler").style.display="block"),delete g.video,just_left=e.name,small_device||window!=window.top||resizer(pcounter),(small_device||tablet)&&(1===pcounter&&(document.id("participants").style.position="relative",document.id("participants").style.top=saved_top),document.id("participants").style.marginTop=1===pcounter?isIOSFirefox()?"-46vh":"-55vh":isIOSFirefox()?"-50vh":"-59vh",1===pcounter&&(document.id("participants").style.height=window==window.top?"50vh":"63vh"),2===pcounter&&(document.id("participants").style.height=window==window.top?"110vh":tablet?"140vh":"128vh"),3===pcounter&&(document.id("participants").style.height=window==window.top?"160vh":"190vh"),4===pcounter&&(document.id("participants").style.height=window==window.top?"220vh":"250vh"),pcounter>4&&(document.id("participants").style.height=window==window.top?"275vh":"300vh"));else{let n=e.name.split("_"),o="DUMMY_"+n[n.length-1];(t=participants[o])&&(participants[o].dispose(),delete participants[o],console.log("dispose 2 in left: real",real_pcnt),pcounter<room_limit&&(document.id("bell").style.display="none",document.id("av_toggler").style.display="block"),just_left=e.name,small_device||resizer(pcounter))}document.id("viewer_menu")&&document.id("viewer_menu").setStyles({opacity:0,zIndex:0})},onViewerLeft=e=>{let t=e.split("_"),n=t[t.length-1];if(document.id("_au_"+n)){document.id("_au_"+n).dispose();let e="..."==document.id("audience_numbers").innerHTML?0:parseInt(document.id("audience_numbers").innerHTML)-1;vcounter=e>0?e:0;let t="video-"+document.id("name").value;now_playing&&0===vcounter&&!shareSomeStream&&function(){document.id(t)&&document.id(t).pause(),__playing=!1}.delay(100),document.id("vcounter")&&(vcounter?document.id("vcounter").innerHTML=vcounter:function(){document.id("vcounter").innerHTML=vcounter}.delay(1e3)),e=e>0?e:"...",document.id("audience_numbers").innerHTML=e;let o=e>0?"#369":"#ccc";document.id("audience_numbers").setStyles({color:o}),document.id("audience_boxx").innerHTML="..."==e?"Audience is empty :(":document.id("audience_boxx").innerHTML,chat_shown=1,document.id("logger").click(),document.id("audience").click();let i=i_am_viewer&&1===vcounter&&cine?1:0,a=i_am_viewer&&1===vcounter&&cine?10111:0;document.id("viewer_menu")&&!lori&&setTimeout((function(){document.id("viewer_menu").setStyles({zIndex:a}),document.id("viewer_menu").fade(i)}),1e3)}},sendMessage=e=>{var t=JSON.stringify(e);problems||ws.send(t)};function startVideo(e){e.play().catch((e=>{"NotAllowedError"===e.name&&console.error("[start] Browser doesn't allow playing video: "+e)}))}function setCookie(e,t,n){var o="";if(n){var i=new Date;i.setTime(i.getTime()+60*n*1e3),o=";expires="+i.toUTCString()+";SameSite=None;Secure;"}document.cookie=e+"="+(t||"")+o+";path=/"}function getCookie(e){for(var t=e+"=",n=document.cookie.split(";"),o=0;o<n.length;o++){for(var i=n[o];" "==i.charAt(0);)i=i.substring(1,i.length);if(0==i.indexOf(t))return i.substring(t.length,i.length)}return null}function eraseCookie(e){document.cookie=e+"=; Path=/; Expires=Thu, 01 Jan 1970 00:00:01 GMT;SameSite=None;Secure;"}function deleteSomeCookies(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){for(var n=e[t],o=n.indexOf("="),i=o>-1?n.substr(0,o):n;" "==i.charAt(0);)i=i.substring(1,i.length);var a=new RegExp("_muted","ig"),r=new RegExp("_hidden","ig");(i.match(a)||i.match(r)||!i.length)&&(document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;SameSite=None;Secure;")}}function listCookies(){for(var e=document.cookie.split(";"),t="",n=1;n<=e.length;n++)t+=n+" "+e[n-1]+"\n";return t}function check_iOS(){var e=navigator.userAgent;return!!(/iPad|iPhone|iPod/.test(e)||"MacIntel"===navigator.platform&&navigator.maxTouchPoints>1)}function isIOSFirefox(){return navigator.userAgent.match("FxiOS")}function is_mobAndro(){var e=navigator.userAgent;return!(!/Android/.test(e)||!window.matchMedia("only screen and (max-width: 480px)").matches)}function makeid(e){for(var t="",n="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",o=0;o<e;o++)t+=n.charAt(Math.floor(62*Math.random()));return t}function saveData(e,t,n){"undefined"!=typeof Storage?localStorage.setItem(e,t):setCookie(e,t,n)}function loadData(e){return"undefined"!=typeof Storage?localStorage.getItem(e):getCookie(e)}function ValidateIPaddress(e){return!!/^(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)$/.test(e)}function ValidateAccountId(e){return!(!/^[a-z0-9]+$/i.test(e)||48!=e.length)}function ValidateAnno(e){return e.length<160&&(e.replace(/[<>]/g,""),!0)}var fullscreen=!1,ios_fullscreen=!1,cinemaEnabled=!1;let already_been_there=!1,first_time=!0;const doSwitchOneMode=(e,t,n)=>{let o=sp_setter_url+"/#/binder/to/:"+t+"/amount/:"+n;request("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((t=>{if(t.length)if(switched)if(playSomeMusic||shareSomeScreen)flashText(playSomeMusic?"PLAYING VIDEO! STOP?":"SHARING SCREEN! STOP?");else{fullscreen=!0,chat_shown=1,document.id("logger").click();let t=/video-/gi,n=e.id.replace(t,""),o=document.id("video-"+n);!o||o.fullscreenElement||check_iOS()||o.requestFullscreen(),function(){if(document.id("room-header").style.display="none",normal_mode&&(document.id("room-backer").style.display="block"),small_device||(document.id("room").style.minWidth="480px",document.id("room").style.marginLeft="0px"),Object.keys(participants).length)for(var e in participants)participants[e].name!=n&&(participants[e].dispose(),delete participants[e])}.delay(500)}else switched=!0,rejoin();else fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl?par=session",{credentials:"include"}).then((e=>e.text())).then((e=>{let t=e;if(t.length){let e=isIOSFirefox()?'<iframe id="sp_setter" name="sp_setter" src="'+o+"/?session="+t+'" scrolling="yes" style="border:0;min-height:400px;background:transparent;text-align:center;margin:-20px auto 0 -20px; width:320px;"></iframe>':'<iframe id="sp_setter" name="sp_setter" src="'+o+"/?session="+t+'" scrolling="yes" style="border:0;min-height:430px;background:transparent;text-align:center;margin:-20px auto 0 -20px; width:320px;"></iframe>';e+='<div id="sp_setter_dummy" style="font-size:18px;position:relative;text-align:center;width:70%;margin:44% auto;display:none;background:#def;">PLEASE WAIT .. LOADING WALLET..</div>';let n=tablet?"42vh":small_device?"64vh":420,i=small_device?24:18;mod6=new mBox.Modal({content:e,setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:i,color:"#222",height:n,maxHeight:"450px"}},width:280,id:"m6",height:n,zIndex:31005,position:"relative",title:"SkyRHC wallet",attach:"newacc"}),document.id("newacc").click(),document.id("sp_setter")&&first_time&&(document.id("sp_setter").style.display="none",document.id("sp_setter_dummy").style.display="block",setTimeout((function(){document.id("sp_setter").style.display="block",document.id("sp_setter_dummy").style.display="none"}),3e3),first_time=!1);let a=(window.innerHeight-540)/2-30;a+="px",small_device||(document.id("m6").style.top=a)}else if(already_been_there)return})).catch((e=>console.log(e)))}))},PARTICIPANT_MAIN_CLASS=small_device?"participant main_i":"participant main",PARTICIPANT_CLASS="participant",PARTICIPANT_SOLO="participant solo",PARTICIPANT_DUO="participant duo",PARTICIPANT_TRIO="participant trio",PARTICIPANT_CUATRO="participant cuatro",PARTICIPANT_CINCO="participant cinco";function Participant(e,t,n,o,i){this.name=e,this.mode=n;let a=!1,r=!1;document.id("dummy_p")&&(document.id("dummy_p").style.display="none"),document.id("dummy2_p")&&(document.id("dummy2_p").style.display="none");var s=new RegExp("GURU:","g");e.match(s)&&(guru_is_here=1,a=!0),t.match(s);new RegExp("^A:","g");let d=0;for(var c in participants)c.match(s)&&d++;if(d>0&&(guru_is_here=1),document.id(e)){var l=document.id(e);l.parentNode.removeChild(l)}var u=!1;all_muted=getCookie("all_muted"),null!==all_muted&&"null"!==all_muted||(all_muted=!1);var m=loadData(e+"_muted");null!==m&&"null"!==m||(m=all_muted),"m"!=n&&"c"!=n&&"p"!=n||(m=!0);var p=loadData(e+"_volume");null!==p&&"null"!==p||(p=a?.7:.5),e!=t&&"m"!=n&&(saveData(e+"_muted",m,1440),saveData(e+"_volume",p,1440)),!0!==all_muted&&"true"!==all_muted||e!=t||(i_am_muted=!0),e==t&&saveData(t+"_muted",i_am_muted,1440);var h=document.createElement("div");h.className=PARTICIPANT_MAIN_CLASS,h.className=0!=pcounter||small_device?h.className:PARTICIPANT_SOLO,h.className=1!=pcounter||small_device?h.className:PARTICIPANT_DUO,h.className=2!=pcounter||small_device?h.className:PARTICIPANT_TRIO,h.className=3!=pcounter||small_device?h.className:PARTICIPANT_CUATRO,h.className=4!=pcounter||small_device?h.className:PARTICIPANT_CINCO,h.style.display="none",h.style.opacity=0,i_am_guest=(0!=document.getElementsByClassName(PARTICIPANT_MAIN_CLASS).length||0!=document.getElementsByClassName(PARTICIPANT_SOLO).length||0!=document.getElementsByClassName(PARTICIPANT_DUO).length||0!=document.getElementsByClassName(PARTICIPANT_TRIO).length||0!=document.getElementsByClassName(PARTICIPANT_CUATRO).length||0!=document.getElementsByClassName(PARTICIPANT_CINCO).length)&1===pcounter?1:i_am_guest,1!=o&&(i_am_guest=1),1==o&0===pcounter&guru_is_here&&(i_am_guest=0),function(){document.id("phones").fade(0),function(){document.id("phones").innerHTML=""}.delay(100)}.delay(500),"undefined"!=typeof mod3&&null!==mod3&&(mod3.content.innerHTML=left_content.get(altlang[ctr])),"undefined"!=typeof mod4&&null!==mod4&&(mod4.content.innerHTML=right_content.get(altlang[ctr])),pcounter++,e==t&&0==o||real_pcnt++,5===real_pcnt&&(elements=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_CUATRO)),elements.forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CINCO}))),4===real_pcnt&&(elements=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_TRIO)),elements.forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CUATRO}))),3===real_pcnt&&(elements=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_DUO)),elements.forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_TRIO}))),2===real_pcnt&&(elements=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_SOLO)),elements.forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_DUO}))),pcounter>room_limit&&(hack=!1),pcounter>5&&U(),function(){h.className=1!==pcounter||small_device?2!==pcounter||small_device?3!==pcounter||small_device?4!==pcounter||small_device?5!==pcounter||small_device?h.className:PARTICIPANT_CINCO:PARTICIPANT_CUATRO:PARTICIPANT_TRIO:PARTICIPANT_DUO:PARTICIPANT_SOLO}.delay(500),document.id("pcounter")&&(real_pcnt?document.id("pcounter").innerHTML=real_pcnt:function(){document.id("pcounter").innerHTML=real_pcnt}.delay(1e3)),h.id=e,h.style.position="relative";var f=document.createElement("span"),v=document.createElement("div"),y=document.createElement("input"),_=document.createElement("video"),w=document.createElement("div"),b=document.createElement("div"),V=document.createElement("div"),k=document.createElement("canvas"),A=k.getContext("2d");document.id("participants").appendChild(h),h.appendChild(_),h.appendChild(f),h.appendChild(v),e==t&&(h.onclick=function(){if(!small_device){document.id("room-header").style.display="none"===document.id("room-header").style.display?"block":"none";let e="none"===document.id("room-header").style.display?0:1;document.id("room-header").fade(e),document.id("room-header-file").style.display="none"===document.id("room-header").style.display?"none":document.id("room-header-file").style.display}}),h.ondblclick=j;var T=e.split("_"),C=T.slice(0,T.length-1).join("_");let x=C.length>11?C.substr(0,11)+"..":C;"DUMMY"!==T[0]&&f.appendChild(document.createTextNode(x)),f.style.zIndex="1002",f.style.cursor="pointer",f.id="span_"+e,f.onclick=function(){fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{1==t&&set_guru(0,e)})).catch((e=>console.log(e)))},"m"==n&&t!=e||(v.addEventListener("click",(function(n){n.preventDefault(),n.stopPropagation(),e!=t?function(){check_iOS()?u=!1:y.style.display="block"==y.style.display?"none":"block";H()}():H()})),v.style.cursor="pointer"),y.addEventListener("change",(function(t){t.preventDefault(),t.stopPropagation(),p=y.value,saveData(e+"_volume",p,1440),saveData(e+"_muted",m=!(p>0),1440),_.volume=p,u=!0,(0===_.volume&&!_.muted||_.volume&&_.muted)&&H()})),e!=t&&_.addEventListener("click",(function(t){var n;t.preventDefault(),t.stopPropagation(),"c"!=participants[e].getMode()?small_device?(n=t.target,isAndroid||ios_fullscreen?!isAndroid&&ios_fullscreen?(h.style.position="relative",h.style.width="96%",document.id("house").style.visibility="visible",document.id("controls").style.display="block",ios_fullscreen=!1,document.id("room_selector").fade(1)):isAndroid&&(h.className==PARTICIPANT_MAIN_CLASS&&D(n),h.className==PARTICIPANT_CLASS&&U()):(document.id("house").style.visibility="hidden",document.id("controls").style.display="none",h.style.position="fixed",h.style.top="0px",h.style.left="0px",h.style.width=window.innerHeight>window.innerWidth?"97vw":"98vw",ios_fullscreen=!0,document.id("room_selector").fade(0))):D(t.target):P(t.target)})),check_iOS()&&_.addEventListener("play",(()=>{window.requestAnimationFrame((function e(){A.drawImage(_,0,0,k.width,k.height),window.requestAnimationFrame(e)}))})),b.onclick=function(t){t.preventDefault(),t.stopPropagation(),fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{if(1==t){let t=participants[e].getMode(),n="c"==t?"v":"c",o=getCookie("authtoken")||"";sendMessage({id:"setCinema",name:e,mode:n,token:o})}})).catch((e=>console.log(e)))},V.onclick=j,v.className="speak",v.id="speaker-"+e;let S="c"==n?"#ff0":"#369";b.style.fontWeight="c"==n?"bold":"normal";let E=shareSomeStream?"STREAM":"c"==n?"CINEMA!":"CINEMA?";if(b.className="onemode",b.id="one-"+e,b.style.zIndex=10002,b.style.opacity=0,b.style.fontSize=small_device?"18px":"14px",b.style.color=shareSomeStream?"#ff0":S,b.style.width=small_device?"72px":b.style.width,b.appendChild(document.createTextNode(E)),"c"!=this.mode&&1!=o&&(b.style.display="none"),1!=o&&"c"!=this.mode||(b.style.display="block"),V.className="dropper",V.id="drop-"+e,V.appendChild(document.createTextNode("X")),V.style.fontSize="16px",y.style.position="relative",y.style.zIndex=10112,_.id="video-"+e,_.autoplay=!0,_.playsInline=!0,_.controls=(function(){var e=navigator.userAgent;if(/iPad/.test(e))return!0}(),!1),_.volume=p,e!=t&&(_.style.cursor="pointer"),"DUMMY"===T[0]){let e=creatu_long_.get(altlang[ctr]);var M=document.createElement("div");M.style.fontSize="18px",M.style.color="#c50",M.style.width="50%",M.style.textAlign="center",M.appendChild(document.createTextNode(e)),M.style.float="none",M.style.margin="-21px auto 0 auto",M.style.cursor="pointer",h.appendChild(M)}y.type="range",y.id="slider_"+e,y.min=0,y.max=1,y.step=.1,y.style.display="none",y.style.width="90px",w.className="locos",w.id="loco_"+e,w.style.fontSize="14px",w.style.color="#9cf";var N=document.createElement("div");N.id="acco_"+e,N.className="accos",h.appendChild(N),h.appendChild(y),h.appendChild(w),h.appendChild(b),e!=t&&h.appendChild(V);var R=document.createElement("div");R.className="annos",R.id="anno_"+e,R.style.fontSize="16px",R.style.paddingLeft="10px",R.style.paddingRight="10px",R.style.opacity=0,R.onclick=function(e){var t;(t=e.target).style.opacity=.02==t.style.opacity?1:.02},h.appendChild(R);var L=document.createElement("div");L.className="lols",L.id="lol_"+e,L.style.fontSize="14px",L.onclick=function(){sendMessage({id:"keyDown",num:85,name:e})},L.style.position="absolute",L.style.zIndex="1001",h.appendChild(L);var I=document.createElement("div");I.className="lols",I.id="rew_"+e,I.style.right="120px",I.style.fontSize="14px",I.onclick=function(){sendMessage({id:"keyDown",num:82,name:e})},I.style.position="absolute",I.style.zIndex="1001",h.appendChild(I);var O=document.createElement("div");O.className="adders",O.style.fontSize="18px",O.style.cursor="pointer",O.style.background=e==t?"#369":"#900",O.id="adder_"+e,O.appendChild(document.createTextNode("A")),O.onclick=function(){who_to=e,document.id("anno_adder").click()},O.style.display=0==o&&t==e?"none":"block",O.style.display=a&&e!=t||"DUMMY"===T[0]?"none":O.style.display,O.style.right=e==t?"0px":"24px",h.appendChild(O),document.id(_.id).style.opacity=!0!==i_am_muted&&"true"!==i_am_muted||!aonly||e!=t?1:0,document.id(_.id).style.maxHeight=!0!==i_am_muted&&"true"!==i_am_muted||!aonly||e!=t?document.id(_.id).style.maxHeight:notebook?"310px":"365px",document.id(_.id).style.maxHeight=notebook?"310px":"365px",!0!==all_muted&&"true"!==all_muted&&!0!==m&&"true"!==m&&e!=t||(_.muted=!0),!0!==_.muted?v.appendChild(document.createTextNode("🔊")):(e!=t&&"m"!=n&&v.appendChild(document.createTextNode("🔇")),e!=t&&"m"==n&&v.appendChild(document.createTextNode("X")),e!=t||!0!==i_am_muted&&"true"!==i_am_muted||playSomeMusic||v.appendChild(document.createTextNode("X")),e==t&&!0===playSomeMusic_muted&&playSomeMusic&&v.appendChild(document.createTextNode("🔇")),e==t&&!1===playSomeMusic_muted&&playSomeMusic&&v.appendChild(document.createTextNode("🔊")),e!=t||!1!==i_am_muted&&"false"!==i_am_muted||playSomeMusic||v.appendChild(document.createTextNode("🎤"))),v.style.fontSize="42px",v.style.right=small_device&&window.top!=window?"10px":v.style.right,this.getVideoElement=function(){return _},this.getCanvasElement=function(){return k};const P=e=>{document.id("house").style.display="block",document.id("house").style.visibility="visible",request("https://"+window.location.hostname+port+"/cgi/genc/get_acc_id.pl").then((t=>{t.length?doSwitchOneMode(e,"5ENzTTUL3zvnMP8usRo3ZcGmMhkaHsvFUP6PMedLV9EWtLFx",5):(afterBinding||(setTimeout((function(){document.id("removerA")&&(document.id("removerA").innerHTML="Error: Service unavailable",function(){document.id("removerA").fade(0)}.delay(1e3))}),1e4),function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+t)}.delay(1e3),document.id("sp_container").style.display="block",sp_shown=1,ch_int=setInterval((function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+t)}),3e5),document.body.scrollTop=document.documentElement.scrollTop=0),afterBinding&&rejoin())}))};function U(){if(!small_device)if(h.className===PARTICIPANT_CLASS){var e=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_MAIN_CLASS));e.forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CLASS})),(e=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_SOLO))).forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CLASS})),(e=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_DUO))).forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CLASS})),(e=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_TRIO))).forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CLASS})),(e=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_CUATRO))).forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CLASS})),(e=Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_CINCO))).forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:PARTICIPANT_CLASS})),h.className=PARTICIPANT_MAIN_CLASS}else h.className=PARTICIPANT_CLASS}function D(e){e.fullscreenElement?e.exitFullscreen&&(e.exitFullscreen(),document.id("room_selector").fade(1)):(e.requestFullscreen(),document.id("room_selector").fade(0))}function H(){if(document.id("video-"+e)){var n=document.id("video-"+e);(!u||u&&(0===n.volume&&!n.muted||n.volume>0))&&(e!=t&&(n.muted=0===n.volume||!n.muted,y.value=n.volume,u=!1,saveData(e+"_muted",n.muted,1440),saveData(e+"_volume",n.volume,1440)),e==t&&playSomeMusic&&(playSomeMusic_muted=!0!==playSomeMusic_muted),v.removeChild(v.childNodes[0]),n.muted||e==t&&playSomeMusic&&!0===playSomeMusic_muted?((e!=t||e==t&&playSomeMusic)&&(v.appendChild(document.createTextNode("🔇")),e==t&&playSomeMusic&&analyser.disconnect()),e!=t||playSomeMusic||(!0===i_am_muted||"true"===i_am_muted?(saveData(t+"_muted",!1,1440),i_am_muted=!1,setCookie("all_muted",!1,1440),flashText_and_rejoin("microphone ON!")):(saveData(t+"_muted",!0,1440),i_am_muted=!0,flashText_and_rejoin("microphone OFF!")))):(v.appendChild(document.createTextNode("🔊")),e==t&&playSomeMusic&&(g.audioContext||(g.audioContext=new AudioContext),mediaSource=g.audioContext.createMediaElementSource(n),analyser=g.audioContext.createAnalyser(),mediaSource.connect(analyser),analyser.connect(g.audioContext.destination))))}}function j(){if(normal_mode){if(e!=t)window.confirm("Drop "+C+"?!")&&fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{if(1==t){let t=getCookie("authtoken")||"";sendMessage({id:"dropGuest",name:e,token:t})}else for(var n in participants)participants[n].name===e&&(participants[n].dispose(),delete participants[n].rtcPeer,delete participants[n])})).catch((e=>console.log(e)))}else{let e=document.location.href.split("#");true_cine?document.location.href=e[0]:document.location.reload()}}this.offerToReceiveVideo=function(t,n,o){if(t)return console.error("sdp offer error");sendMessage({id:"receiveVideoFrom",sender:e,sdpOffer:n})},this.onIceCandidate=function(t,n){sendMessage({id:"onIceCandidate",candidate:t,name:e})},Object.defineProperty(this,"rtcPeer",{writable:!0}),this.dispose=function(){var n=new RegExp("GURU:","g");let i=0;for(var a in participants)a.match(n)&&i++;(e.match(n)&&1==i&&(guru_is_here=0,setTimeout((function(){0}),2e3)),this.rtcPeer&&(this.rtcPeer,1)&&this.rtcPeer.dispose(),h&&h.parentNode&&h.parentNode.removeChild(h),--pcounter<=room_limit&&!i_am_viewer&&(hack=!0),pcounter<6)&&Array.prototype.slice.call(document.getElementsByClassName(PARTICIPANT_CLASS)).forEach((function(e){e.className=small_device?PARTICIPANT_MAIN_CLASS:1===pcounter?PARTICIPANT_SOLO:2===pcounter?PARTICIPANT_DUO:3===pcounter?PARTICIPANT_TRIO:4===pcounter?PARTICIPANT_CUATRO:5===pcounter?PARTICIPANT_CINCO:e.className}));e==t&&0==o||real_pcnt--,document.id("pcounter")&&(real_pcnt?document.id("pcounter").innerHTML=real_pcnt:function(){document.id("pcounter").innerHTML=real_pcnt}.delay(1e3)),0==guru_is_here&pcounter&&(i_am_guest=1),1==guru_is_here&1===pcounter&&(i_am_guest=0),i>1&&(i_am_guest=0,guru_is_here=1)},this.setMode=function(e){this.mode=e},this.getMode=function(){return this.mode}}var loado_=new Map([["en","..loading.."],["ru","..загрузка.."],["es","..cargando.."],["fr","..chargement.."],["cn","..loading.."],["pt","..carregando.."]]),heads1=new Map([["en","Enter Rumhaus"],["ru","Войти в румхаус"],["es","Entrar Rumhaus"],["fr","Entrer Rumhaus"],["cn","進入 Rumhaus"],["pt","Entrar Rumhaus"]]),about=new Map([["en","about R-H"],["ru","о R-H"],["es","sobre R-H"],["fr","à propos"],["cn","關於"],["pt","sobre R-H"]]),help=new Map([["en","help"],["ru","помощь"],["es","ayuda"],["fr","aide"],["cn","幫助"],["pt","ajuda"]]),warner=new Map([["en","RE-CONNECTING .."],["ru","соединение .."],["es","RECONECTANDO .."],["fr","RECONNEXION .."],["cn","RE-CONNECTING .."],["pt","RECONECTANDO .."]]),badger_=new Map([["en","ENTER AS"],["ru","ВОЙТИ КАК"],["es","ENTRAR COMO"],["fr","ENTRER COMME"],["cn","ENTER AS"],["pt","ENTER AS"]]),learner_=new Map([["en","learn"],["ru","узнать"],["es","learn"],["fr","learn"],["cn","learn"],["pt","learn"]]),morer_=new Map([["en","more"],["ru","правила"],["es","more"],["fr","more"],["cn","more"],["pt","more"]]),about_content=new Map([["en",'<div class="centered modal_text">Room-House is a free media network. You can setup your own Room-House node on your home computer to meet with friends, colleagues or clients in a private room: use this <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>how to</a> for a start; or choose an existing R-H from this <a href="https://room-house.com" target=new>big list</a>. You can write us on our <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>'],["ru",'<div class="centered modal_text">Room-House это свободная медиа сеть. Вы можете установить узел Room-House у себя на компьютере: см. <a href="https://github.com/kl3eo/room-house/blob/main/xTER_Room-House_Rus_v2_1_1.pdf" target=new>как</a> и используйте его для встреч с друзьями, коллегами, клиентами, и т.д. Вы можете написать нам в <a href="https://twitter.com/RoomHouseOffic1" target=new>Твиттер</a>.</div>'],["es",'<div class="centered modal_text">¿Que Debes? - registrarse como el GURU <a href=https://validate.guru target=new>aqui</a>. <br> ¿Que Puedes? - a. Mostrar su propio seleccion de videos. <br> b. Bloquear a los que molestan al publico. <br> c. Tener su propio voto del dia.<br>d. Y otras preferencias del GURU.</div>'],["fr",'<div class="centered modal_text">Room-House est un réseau média libre. Configurez votre propre Room-House sur votre ordinateur connecté à Internet: lire <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>comment</a> et utilisez-le pour rencontrer des amis,  collègues, clients, etc, ou choisissez un R-H de celui-ci <a href="https://room-house.com" target=new>liste</a>. Vous avez la chance de nous trouver sur notre <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>'],["cn",'<div class="centered modal_text">R-H 是一個免費的媒體網絡。您可以在家用電腦上設置自己的 Room-House 節點，以私密方式與朋友、同事或客戶會面: 讀 <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>這</a> 並用於會見朋友、同事、客戶等，或從中選擇一個工作 R-H <a href="https://room-house.com" target=new>列表t</a>. 您有幸在我們的推特上找到我們 <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>'],["pt",'<div class="centered modal_text">Room-House é uma rede de mídia libre. Você pode configurar sua própria Room-House em seu laptop conectado à Internet: <a href="https://github.com/kl3eo/room-house/blob/main/xTER_VB_install.txt" target=new>leia</a> para encontrar amigos, colegas, clientes, etc, ou escolha um R-H funcional desta <a href="https://room-house.com" target=new>lista</a>. Você tem a sorte de nos encontrar em nosso <a href="https://twitter.com/RoomHouseOffic1" target=new>twitter</a>.</div>']]),help_content=new Map([["en",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. Exit Chat? - Reload Window, Ctrl-R <br>b. Drop Video? - Double-click on Video\'s "name". <br>c. Mute/Unmute? - click on speaker icons.<br>d. Expand Video? - Ctrl+, use Picture in Picture, or swipe to zoom. Click on Video to possible full screen.<br>e. Any problems? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["ru",'<div class="centered modal_text">a. Выйти? - последняя кнопка в меню. <br>b. Убрать Video? - Кликнуть на "X" справа вверху квадрата. <br>c. Убрать звук от видео или микрофона: клик по иконке "звук" справа от имени.<br>d. Увеличить Video? - клик на видео, Ctrl+, Picture in Picture, swipe.<br>e. Проблемы? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["es",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. ¿Salir del chat? - recargar, Ctrl-R <br> b. Soltar un video? - clic en "nombre" abajo del video. <br> c. Silenciar un video/su microphono - clic en el icono bajo derecho. <br> d. ¿Expandir un video? - use Picture in Picture, o deslice para acercar.<br>e. Algun problema irresistible? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["fr",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. Quitter le chat ? - Rechargez, Ctrl-R <br>b. Déposer la vidéo ? - Cliquez sur "name". <br>c. Désactiver le son ? - clique sur la Speaker.<br>d. Agrandir la vidéo ? - Picture in Picture, ou faites glisser pour effectuer un zoom.<br>e. Quelques problemes? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["cn",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>一個。退出聊天？ - 關閉窗口，Ctrl-R <br>b。殺死壞視頻？ - 單擊名稱旁邊的“”，或雙擊/點擊視頻。 <br>c.靜音/取消靜音？ - 單擊/點擊視頻。<br>d. 展開視頻？ - 在桌面上，使用畫中畫，在移動瀏覽器上 - 滑動以放大或縮小。<br>e.任何問題？- <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>'],["pt",'<div class="centered modal_text">Please, read the <a href=https://sky-pirl.gitbook.io/skypirl/room-house.com target=new>manual</a>!<br>a. Sair? - Recarregar Ctrl-R <br> b. Soltar um vídeo? - Clique no "name" ou cliqu duas vezes no vídeo. <br> c. Desativar o som? - clique no Speaker. <br> d. Expanda o vídeo? - use Picture in Picture, ou deslize para aumentar o zoom.<br>e. Algum problem? - <span style="color:#009;text-decoration:underline;" onclick="var yon = window.confirm(\'OK?\');if (yon) {clearAllCookies();location.reload();};">Clear Cookies</span>.</div>']]),left_content=new Map([["en",'Yes, now please say "Messi!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=lsender_left value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["ru",'Да, теперь, пожалуйста, скажи "Месси!" ГРОМКО в микрофон, чтобы подтвердить свой голос. Спасибо! <input type=text id=lsender_left value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["es",'Sí, ahora por favor di "¡Messi!" VOZ ALTA en el micrófono para redoblar su voto. Gracias por votar! Tambien puedes escribir algo: <input type=text id=lsender_left value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["fr","Oui, maintenant, s'il vous plaît, dites 'Messi!' FORT dans le micro pour confirmer votre vote. Merci d'avoir voté! You may also write some words: <input type=text id=rsender value='' onkeydown='var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value});mod3.close();} else {this.placeholder = '???';}}'>"],["cn",'Yes, now please say "Messi!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=lsender_left value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">'],["pt",'Sim, agora por favor diga "Messi!" ALTO no microfone para confirmar seu voto. Obrigado por votar! You may also write some words: <input type=text id=lsender_left value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod3.close();} else {this.placeholder = \'???\';}}">']]),right_content=new Map([["en",'Yes, now please say "Ronaldo!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["ru",'Да, теперь, пожалуйста, скажи "Роналдо!" ГРОМКО в микрофон, чтобы подтвердить свой голос. Спасибо! <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["es",'Sí, ahora por favor di "¡Ronaldo!" VOZ ALTA en el micrófono para redoblar su voto. Gracias por votar! Tambien puedes escribir algo: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["fr","Oui, maintenant, s'il vous plaît, dites 'Ronaldo!' FORT dans le micro pour confirmer votre vote. Merci d'avoir voté! You may also write some words: <input type=text id=rsender value='' onkeydown='var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value});mod4.close();} else {this.placeholder = '???';}}'>"],["cn",'Yes, now please say "Ronaldo!" LOUDLY in microphone to redouble your vote. Thank you for voting! You may also write some words: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">'],["pt",'Sim, agora por favor diga "Ronaldo!" ALTO no microfone para confirmar seu voto. Obrigado por votar! You may also write some words: <input type=text id=rsender value="" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : \'writeToLog\', text:this.value});mod4.close();} else {this.placeholder = \'???\';}}">']]),central_content=new Map([["en","WRITE TO CHAT: <input type=text id=lsender_central value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();document.body.style.background = '#112';cli5();} else {this.placeholder = '???';}}\">"],["ru","WRITE TO CHAT: <input type=text id=lsender_central value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();document.body.style.background = '#112';cli5();} else {this.placeholder = '???';}}\">"],["es","WRITE TO CHAT: <input type=text id=lsender_central value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();document.body.style.background = '#112';cli5();} else {this.placeholder = '???';}}\">"],["fr","WRITE TO CHAT: <input type=text id=lsender_central value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();document.body.style.background = '#112';cli5();} else {this.placeholder = '???';}}\">"],["cn","WRITE TO CHAT: <input type=text id=lsender_central value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();document.body.style.background = '#112';cli5();} else {this.placeholder = '???';}}\">"],["pt","WRITE TO CHAT: <input type=text id=lsender_central value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'writeToLog', text:this.value.replace(/'/g, '')});mod5.close();document.body.style.background = '#112'; cli5();} else {this.placeholder = '???';}}\">"]]),anno_adder_content=new Map([["en","SET ANNOTATION: <input type=text id=asender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; let tok = getCookie('authtoken') || ''; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'setAnno', anno:this.value.replace(/'/g, ''), addr: who_to, token: tok});mod7.close();} else {this.placeholder = '???';}}\">"],["ru","КОММЕНТАРИЙ: <input type=text id=asender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; let tok = getCookie('authtoken') || ''; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'setAnno', anno:this.value.replace(/'/g, ''), addr: who_to, token: tok});mod7.close();} else {this.placeholder = '???';}}\">"],["es","SET ANNOTATION: <input type=text id=asender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; let tok = getCookie('authtoken') || ''; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'setAnno', anno:this.value.replace(/'/g, ''), addr: who_to, token: tok});mod7.close();} else {this.placeholder = '???';}}\">"],["fr","SET ANNOTATION: <input type=text id=asender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; let tok = getCookie('authtoken') || ''; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'setAnno', anno:this.value.replace(/'/g, ''), addr: who_to, token: tok});mod7.close();} else {this.placeholder = '???';}}\">"],["cn","SET ANNOTATION: <input type=text id=asender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; let tok = getCookie('authtoken') || ''; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'setAnno', anno:this.value.replace(/'/g, ''), addr: who_to, token: tok});mod7.close();} else {this.placeholder = '???';}}\">"],["pt","SET ANNOTATION: <input type=text id=asender value=\"\" onkeydown=\"var Ucode=event.keyCode? event.keyCode : event.charCode; let tok = getCookie('authtoken') || ''; if (Ucode == 13) {if (this.value.length) {sendMessage({id : 'setAnno', anno:this.value.replace(/'/g, ''), addr: who_to, token: tok});mod7.close();} else {this.placeholder = '???';}}\">"]]),stream_adder_content=new Map([["en",'ADD STREAM: <input type=text id=lsender_stream value="https://nhkwlive-ojp.akamaized.net/hls/live/2003459/nhkwlive-ojp-en/index.m3u8" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {mod8.close();gifrid=this.value;gifr(this.value)} else {this.placeholder = \'???\';}}">'],["ru",'ADD STREAM: <input type=text id=lsender_stream value="https://nhkwlive-ojp.akamaized.net/hls/live/2003459/nhkwlive-ojp-en/index.m3u8" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {mod8.close();gifrid=this.value;gifr(this.value)} else {this.placeholder = \'???\';}}">'],["es",'ADD STREAM: <input type=text id=lsender_stream value="https://nhkwlive-ojp.akamaized.net/hls/live/2003459/nhkwlive-ojp-en/index.m3u8" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {mod8.close();gifrid=this.value;gifr(this.value)} else {this.placeholder = \'???\';}}">'],["fr",'ADD STREAM: <input type=text id=lsender_stream value="https://nhkwlive-ojp.akamaized.net/hls/live/2003459/nhkwlive-ojp-en/index.m3u8" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {mod8.close();gifrid=this.value;gifr(this.value)} else {this.placeholder = \'???\';}}">'],["cn",'ADD STREAM: <input type=text id=lsender_stream value="https://nhkwlive-ojp.akamaized.net/hls/live/2003459/nhkwlive-ojp-en/index.m3u8" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {mod8.close();gifrid=this.value;gifr(this.value)} else {this.placeholder = \'???\';}}">'],["pt",'ADD STREAM: <input type=text id=lsender_stream value="https://nhkwlive-ojp.akamaized.net/hls/live/2003459/nhkwlive-ojp-en/index.m3u8" onkeydown="var Ucode=event.keyCode? event.keyCode : event.charCode; if (Ucode == 13) {if (this.value.length) {mod8.close();gifrid=this.value;gifr(this.value)} else {this.placeholder = \'???\';}}">']]),left_label=new Map([["en","for MESSI:"],["ru","за Месси:"],["es","por MESSI:"],["fr","pour MESSI:"],["cn","for MESSI:"],["pt","por MESSI:"]]),right_label=new Map([["en","for RONALDO:"],["ru","за Роналдо:"],["es","por RONALDO:"],["fr","pour RONALDO:"],["cn","for RONALDO:"],["pt","por RONALDO:"]]),sorry_=new Map([["en","Sorry"],["ru","Извините, никого нет."],["es","Lo siento"],["fr","Désolé"],["cn","Sorry"],["pt","Desculpe"]]),waiter_=new Map([["en","..waiting.."],["ru","..ожидание.."],["es","..esperando.."],["fr","..en attente.."],["cn","..waiting.."],["pt","..esperando.."]]),caller_=new Map([["en","CALL GURU "],["ru","НАЖМИТЕ "],["es","CALL GURU "],["fr","CALL GURU "],["cn","CALL GURU "],["pt","CALL GURU "]]),requ_=new Map([["en","is requesting"],["ru","в ожидании"],["es","is requesting"],["fr","is requesting"],["cn","is requesting"],["pt","is requesting"]]),creatu_=new Map([["en","NEED A TICKET!"],["ru","НУЖЕН TICKET!"],["es","NEED A TICKET!"],["fr","NEED A TICKET!"],["cn","NEED A TICKET!"],["pt","NEED A TICKET!"]]),creatu_long_=new Map([["en","NEED a TICKET TO CINEMA!"],["ru","ДЛЯ ПРОСМОТРА НУЖЕН БИЛЕТ!"],["es","NEED a TICKET TO CINEMA!"],["fr","NEED a TICKET TO CINEMA!"],["cn","NEED a TICKET TO CINEMA!"],["pt","NEED a TICKET TO CINEMA!"]]),hea_=new Map([["en","VIDEOCHAT WITHOUT REGISTER"],["ru","ВИДЕОЧАТ БЕЗ РЕГИСТРАЦИИ"],["es","VIDEOCHAT WITHOUT REGISTER"],["fr","VIDEOCHAT WITHOUT REGISTER"],["cn","VIDEOCHAT WITHOUT REGISTER"],["pt","VIDEOCHAT WITHOUT REGISTER"]]),today_=new Map([["en","today guests"],["ru","сегодня следов"],["es","hoy huespedes"],["fr","hotes de jour"],["cn","today guests"],["pt","hoje hospedes"]]),now_=new Map([["en","now"],["ru","сейчас"],["es","ahora"],["fr","ici"],["cn","now"],["pt","agora"]]),roo_=new Map([["en","ROOM"],["ru","КОМНАТА"],["es","QUARTO"],["fr","CHAMBRE"],["cn","ROOM"],["pt","QUARTO"]]),buy_=new Map([["en",'<a href="https://room-house.com/contact_en.html" style="color:#ff1493;">BUY IT!</a> for $75'],["ru",'<a href="https://room-house.com/contact_ru.html" style="color:#ff1493;">КУПИТЬ!</a> за 4990 руб'],["es",'<a href="https://room-house.com/contact_en.html" style="color:#ff1493;">BUY IT!</a> for 75 EURO'],["fr",'<a href="https://room-house.com/contact_en.html" style="color:#ff1493;">BUY IT!</a> for 75 EURO'],["cn",'<a href="https://room-house.com/contact_en.html" style="color:#ff1493;">BUY IT!</a> for 500CNY'],["pt",'<a href="https://room-house.com/contact_en.html" style="color:#ff1493;">BUY IT!</a> for 75 EURO']]),go_=new Map([["en","go to room "],["ru","перейти в "],["es","pasar a "],["fr","aller a "],["cn","go to room "],["pt","pasar a "]]),he_=new Map([["en","HELP"],["ru","ПОМОЩЬ"],["es","AYUDA"],["fr","HELP"],["cn","HELP"],["pt","AJUDA"]]),lo_=new Map([["en","This door is locked now.<br>Please use password to enter."],["ru","Эта дверь сейчас закрыта.<br>Пожалуйста, используйте ПАРОЛЬ для входа."],["es","La puerta esta cerrada ahora.<br>Usa su contrasena por favor."],["fr","La porte est fermee maintenent.<br>Utilise votre mot de passe."],["cn","This door is locked now.<br>Please use password to enter."],["pt","This door is locked now.<br>Please use password to enter."]]),du_=new Map([["en","CLICK MENU TO ACTIVATE CAMERA!"],["ru","КЛИКНИТЕ МЕНЮ ДЛЯ ВКЛЮЧЕНИЯ КАМЕРЫ!"],["es","CLICK MENU TO ACTIVATE CAMERA!"],["fr","CLICK MENU TO ACTIVATE CAMERA!"],["cn","CLICK MENU TO ACTIVATE CAMERA!"],["pt","CLICK MENU TO ACTIVATE CAMERA!"]]),du2_=new Map([["en",'..THEN CLICK &rarr;<br>TO ADD COMMENT!<div class="adders" style="opacity:0.7;font-size:18px;">A</div>'],["ru",'..ПОТОМ НАЖМИТЕ &rarr;<br>на КРУЖОК "A"<br>И ДОБАВЬТЕ КОММЕНТ<div class="adders" style="opacity:0.7;font-size:18px;">A</div>'],["es",'..THEN CLICK &rarr;<br>TO ADD COMMENT!<div class="adders" style="opacity:0.7;font-size:18px;">A</div>'],["fr",'..THEN CLICK &rarr;<br>TO ADD COMMENT!<div class="adders" style="opacity:0.7;font-size:18px;">A</div>'],["cn",'..THEN CLICK &rarr;<br>TO ADD COMMENT!<div class="adders" style="opacity:0.7;font-size:18px;">A</div>'],["pt",'..THEN CLICK &rarr;<br>TO ADD COMMENT!<div class="adders" style="opacity:0.7;font-size:18px;">A</div>']]);!function(e){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=e();else if("function"==typeof define&&define.amd)define([],e);else{("undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self?self:this).kurentoUtils=e()}}((function(){return function e(t,n,o){function i(r,s){if(!n[r]){if(!t[r]){var d="function"==typeof require&&require;if(!s&&d)return d(r,!0);if(a)return a(r,!0);var c=new Error("Cannot find module '"+r+"'");throw c.code="MODULE_NOT_FOUND",c}var l=n[r]={exports:{}};t[r][0].call(l.exports,(function(e){return i(t[r][1][e]||e)}),l,l.exports,e,t,n,o)}return n[r].exports}for(var a="function"==typeof require&&require,r=0;r<o.length;r++)i(o[r]);return i}({1:[function(e,t,n){var o=e("freeice"),i=e("inherits"),a=e("ua-parser-js"),r=e("uuid/v4"),s=e("hark"),d=e("events").EventEmitter,c=e("merge").recursive.bind(void 0,!0),l=e("sdp-translator"),u="undefined"==typeof window?console:window.Logger||console;try{e("kurento-browser-extensions")}catch(e){"undefined"==typeof getScreenConstraints&&(u.warn("screen sharing is not available"),getScreenConstraints=function(e,t){t(new Error("This library is not enabled for screen sharing"))})}var m={audio:!0,video:{width:640,framerate:15}},p=new a("undefined"!=typeof window&&window.navigator?window.navigator.userAgent:"").getBrowser();"IE"===p.name&&function(e){var t=document.createElement("script");t.src=e;var n=document.querySelector("script");n.parentNode.insertBefore(t,n)}("https://cdn.temasys.io/adapterjs/0.15.x/adapter.debug.js");var h=!1;function f(e){e&&u.error(e)}function g(e){e.stop&&e.stop()}function v(e){e.getTracks().forEach(g)}"Chrome"!==p.name&&"Chromium"!==p.name||(h=!0);function y(e,t){var n=[];return function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onsignalingstatechange=e:t.addEventListener("signalingstatechange",e)}((function(){if("stable"===e.signalingState)for(;n.length;){var t=n.shift();e.addIceCandidate(t.candidate,t.callback,t.callback)}}),e),function(o,i){switch(i=i||t,e.signalingState){case"closed":i(new Error("PeerConnection object is closed"));break;case"stable":if(e.remoteDescription){e.addIceCandidate(o,i,i);break}default:n.push({candidate:o,callback:i})}}}function _(e){var t=e.getVideoTracks();if(!t.length)return u.warn("No video tracks available in the video stream"),"";var n=["a=x-google-flag:conference","a=ssrc-group:SIM 1 2 3","a=ssrc:1 cname:localVideo","a=ssrc:1 msid:"+e.id+" "+t[0].id,"a=ssrc:1 mslabel:"+e.id,"a=ssrc:1 label:"+t[0].id,"a=ssrc:2 cname:localVideo","a=ssrc:2 msid:"+e.id+" "+t[0].id,"a=ssrc:2 mslabel:"+e.id,"a=ssrc:2 label:"+t[0].id,"a=ssrc:3 cname:localVideo","a=ssrc:3 msid:"+e.id+" "+t[0].id,"a=ssrc:3 mslabel:"+e.id,"a=ssrc:3 label:"+t[0].id];return n.push(""),n.join("\n")}function w(e,t,n){if(!(this instanceof w))return new w(e,t,n);w.super_.call(this),t instanceof Function&&(n=t,t=void 0),t=t||{},n=(n||f).bind(this);var i,a=this,s=t.localVideo,g=t.remoteVideo,v=t.videoStream,b=t.audioStream,V=t.mediaConstraints,k=t.peerConnection,A=t.sendSource||"webcam",T=t.dataChannelConfig,C=t.dataChannels||!1,x=r(),S=c({iceServers:o()},t.configuration),E=t.onicecandidate;E&&this.on("icecandidate",E);var M=t.oncandidategatheringdone;M&&this.on("candidategatheringdone",M);var N=t.simulcast,R=t.multistream,L=new l.Interop,I=[],O=!1;if(Object.defineProperties(this,{peerConnection:{get:function(){return k}},id:{value:t.id||x,writable:!1},remoteVideo:{get:function(){return g}},localVideo:{get:function(){return s}},dataChannel:{get:function(){return i}},currentFrame:{get:function(){if(g){if(g.readyState<g.HAVE_CURRENT_DATA)throw new Error("No video stream data available");var e=document.createElement("canvas");return e.width=g.videoWidth,e.height=g.videoHeight,e.getContext("2d").drawImage(g,0,0),e}}}}),!k&&(k=new RTCPeerConnection(S),C&&!i)){var P="WebRtcPeer-"+a.id,U=void 0;T&&(P=T.id||P,U=T.options),i=k.createDataChannel(P,U),T&&(i.onopen=T.onopen,i.onclose=T.onclose,i.onmessage=T.onmessage,i.onbufferedamountlow=T.onbufferedamountlow,i.onerror=T.onerror||f)}!k.getLocalStreams&&k.getSenders&&(k.getLocalStreams=function(){var e=new MediaStream;return k.getSenders().forEach((function(t){e.addTrack(t.track)})),[e]}),!k.getRemoteStreams&&k.getReceivers&&(k.getRemoteStreams=function(){var e=new MediaStream;return k.getReceivers().forEach((function(t){e.addTrack(t.track)})),[e]});!function(e,t){"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?t.onicecandidate=e:t.addEventListener("icecandidate",e)}((function(e){var t,n=e.candidate;d.listenerCount(a,"icecandidate")||d.listenerCount(a,"candidategatheringdone")?n?(t=R&&h?L.candidateToUnifiedPlan(n):n,"undefined"==typeof AdapterJS&&a.emit("icecandidate",t),O=!1):O||("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?d.prototype.emit("candidategatheringdone",t):a.emit("candidategatheringdone"),O=!0):O||(I.push(n),n||(O=!0))}),k),k.onaddstream=t.onaddstream,k.onnegotiationneeded=t.onnegotiationneeded,this.on("newListener",(function(e,t){if("icecandidate"===e||"candidategatheringdone"===e)for(;I.length;){var n=I.shift();!n==("candidategatheringdone"===e)&&t(n)}}));var D=y(k);function H(){if(g){g.pause();var e=k.getRemoteStreams()[0];g.srcObject=e,"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?g=attachMediaStream(g,e):g.load()}}function j(e){var t,n;return N&&("Chrome"===p.name||"Chromium"===p.name?e=new RTCSessionDescription({type:e.type,sdp:(t=e.sdp,n=t.indexOf("a=ssrc-group:FID"),(n>0?t.slice(0,n):t)+_(v))}):u.warn("Simulcast is only available in Chrome browser.")),e}function B(){"closed"===k.signalingState&&n('The peer connection object is in "closed" state. This is most likely due to an invocation of the dispose method before accepting in the dialogue'),v&&s&&a.showLocalVideo(),v&&v.getTracks().forEach((function(e){k.addTrack(e,v)})),b&&b.getTracks().forEach((function(e){k.addTrack(e,b)})),n()}if(this.addIceCandidate=function(e,t){var n;n=R&&h?L.candidateToPlanB(e):new RTCIceCandidate(e),t=(t||f).bind(this),D(n,t)},this.generateOffer=function(t){if(t=t.bind(this),"recvonly"===e){var n=!V||"boolean"!=typeof V.audio||V.audio,o=!V||"boolean"!=typeof V.video||V.video;n&&k.addTransceiver("audio",{direction:"recvonly"}),o&&k.addTransceiver("video",{direction:"recvonly"})}else"sendonly"===e&&k.getTransceivers().forEach((function(e){e.direction="sendonly"}));if("undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9){var i=function(){!function(e){for(var t=(new Date).getTime(),n=0;n<1e7&&!((new Date).getTime()-t>e);n++);}(1e3);var e=k.localDescription;R&&h&&(e=L.toUnifiedPlan(e)),t(null,e.sdp,a.processAnswer.bind(a))};k.createOffer((function(e){k.setLocalDescription(e,i,t)}),t)}else k.createOffer().then((function(e){return e=j(e),k.setLocalDescription(e)})).then((function(){var e=k.localDescription;R&&h&&(e=L.toUnifiedPlan(e)),t(null,e.sdp,a.processAnswer.bind(a))})).catch(t)},this.getLocalSessionDescriptor=function(){return k.localDescription},this.getRemoteSessionDescriptor=function(){return k.remoteDescription},this.showLocalVideo=function(){s.srcObject=v,s.muted=!0,"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9&&(s=attachMediaStream(s,v))},this.send=function(e){i&&"open"===i.readyState?i.send(e):u.warn("Trying to send data over a non-existing or closed data channel")},this.processAnswer=function(e,t){t=(t||f).bind(this);var n=new RTCSessionDescription({type:"answer",sdp:e});R&&h&&(n=L.toPlanB(n));if("closed"===k.signalingState)return t("PeerConnection is closed");k.setRemoteDescription(n).then((function(){H(),t()}),t)},this.processOffer=function(e,t){t=t.bind(this);var n=new RTCSessionDescription({type:"offer",sdp:e});R&&h&&(n=L.toPlanB(n));if("closed"===k.signalingState)return t("PeerConnection is closed");k.setRemoteDescription(n).then((function(){return H()})).then((function(){return k.createAnswer()})).then((function(e){return e=j(e),k.setLocalDescription(e)})).then((function(){var e=k.localDescription;R&&h&&(e=L.toUnifiedPlan(e)),t(null,e.sdp)})).catch(t)},"recvonly"===e||v||b)setTimeout(B,0);else{function z(e){void 0===e&&(e=m),"undefined"!=typeof AdapterJS&&"IE"===AdapterJS.webrtcDetectedBrowser&&AdapterJS.webrtcDetectedVersion>=9?navigator.getUserMedia(e,(function(e){v=e,B()}),n):navigator.mediaDevices.getUserMedia(e).then((function(e){v=e,B()})).catch(n)}"webcam"===A?z(V):getScreenConstraints(A,(function(e,t){if(e)return n(e);constraints=[V],constraints.unshift(t),z(c.apply(void 0,constraints))}),x)}this.on("_dispose",(function(){s&&(s.pause(),s.srcObject=null,"undefined"==typeof AdapterJS&&s.load(),s.muted=!1),g&&(g.pause(),g.srcObject=null,"undefined"==typeof AdapterJS&&g.load()),a.removeAllListeners(),"undefined"!=typeof window&&void 0!==window.cancelChooseDesktopMedia&&window.cancelChooseDesktopMedia(x)}))}function b(e){var t="get"+e+"Tracks";return{enumerable:!0,get:function(){if(this.peerConnection){var e=this.peerConnection.getLocalStreams();if(e.length){for(var n,o=0;n=e[o];o++)for(var i,a=n[t](),r=0;i=a[r];r++)if(!i.enabled)return!1;return!0}}},set:function(e){function n(t){t.enabled=e}this.peerConnection.getLocalStreams().forEach((function(e){e[t]().forEach(n)}))}}}function V(e,t){if(!(this instanceof V))return new V(e,t);V.super_.call(this,"recvonly",e,t)}function k(e,t){if(!(this instanceof k))return new k(e,t);k.super_.call(this,"sendonly",e,t)}function A(e,t){if(!(this instanceof A))return new A(e,t);A.super_.call(this,"sendrecv",e,t)}i(w,d),Object.defineProperties(w.prototype,{enabled:{enumerable:!0,get:function(){return this.audioEnabled&&this.videoEnabled},set:function(e){this.audioEnabled=this.videoEnabled=e}},audioEnabled:b("Audio"),videoEnabled:b("Video")}),w.prototype.getLocalStream=function(e){if(this.peerConnection)return this.peerConnection.getLocalStreams()[e||0]},w.prototype.getRemoteStream=function(e){if(this.peerConnection)return this.peerConnection.getRemoteStreams()[e||0]},w.prototype.dispose=function(){var e=this.peerConnection,t=this.dataChannel;try{if(t){if("closed"===t.readyState)return;t.close()}if(e){if("closed"===e.signalingState)return;e.getLocalStreams().forEach(v),e.close()}}catch(e){u.warn("Exception disposing webrtc peer "+e)}"undefined"==typeof AdapterJS&&this.emit("_dispose")},i(V,w),i(k,w),i(A,w),n.bufferizeCandidates=y,n.WebRtcPeerRecvonly=V,n.WebRtcPeerSendonly=k,n.WebRtcPeerSendrecv=A,n.hark=function(e,t){return s(e,t)}},{events:4,freeice:5,hark:8,inherits:9,"kurento-browser-extensions":10,merge:11,"sdp-translator":18,"ua-parser-js":21,"uuid/v4":24}],2:[function(e,t,n){window.addEventListener&&(t.exports=e("./index"))},{"./index":3}],3:[function(e,t,n){var o=e("./WebRtcPeer");n.WebRtcPeer=o},{"./WebRtcPeer":1}],4:[function(e,t,n){var o=Object.create||function(e){var t=function(){};return t.prototype=e,new t},i=Object.keys||function(e){var t=[];for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t.push(n);return n},a=Function.prototype.bind||function(e){var t=this;return function(){return t.apply(e,arguments)}};function r(){this._events&&Object.prototype.hasOwnProperty.call(this,"_events")||(this._events=o(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0}t.exports=r,r.EventEmitter=r,r.prototype._events=void 0,r.prototype._maxListeners=void 0;var s,d=10;try{var c={};Object.defineProperty&&Object.defineProperty(c,"x",{value:0}),s=0===c.x}catch(e){s=!1}function l(e){return void 0===e._maxListeners?r.defaultMaxListeners:e._maxListeners}function u(e,t,n,i){var a,r,s;if("function"!=typeof n)throw new TypeError('"listener" argument must be a function');if((r=e._events)?(r.newListener&&(e.emit("newListener",t,n.listener?n.listener:n),r=e._events),s=r[t]):(r=e._events=o(null),e._eventsCount=0),s){if("function"==typeof s?s=r[t]=i?[n,s]:[s,n]:i?s.unshift(n):s.push(n),!s.warned&&(a=l(e))&&a>0&&s.length>a){s.warned=!0;var d=new Error("Possible EventEmitter memory leak detected. "+s.length+' "'+String(t)+'" listeners added. Use emitter.setMaxListeners() to increase limit.');d.name="MaxListenersExceededWarning",d.emitter=e,d.type=t,d.count=s.length,"object"==typeof console&&console.warn&&console.warn("%s: %s",d.name,d.message)}}else s=r[t]=n,++e._eventsCount;return e}function m(){if(!this.fired)switch(this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length){case 0:return this.listener.call(this.target);case 1:return this.listener.call(this.target,arguments[0]);case 2:return this.listener.call(this.target,arguments[0],arguments[1]);case 3:return this.listener.call(this.target,arguments[0],arguments[1],arguments[2]);default:for(var e=new Array(arguments.length),t=0;t<e.length;++t)e[t]=arguments[t];this.listener.apply(this.target,e)}}function p(e,t,n){var o={fired:!1,wrapFn:void 0,target:e,type:t,listener:n},i=a.call(m,o);return i.listener=n,o.wrapFn=i,i}function h(e,t,n){var o=e._events;if(!o)return[];var i=o[t];return i?"function"==typeof i?n?[i.listener||i]:[i]:n?function(e){for(var t=new Array(e.length),n=0;n<t.length;++n)t[n]=e[n].listener||e[n];return t}(i):g(i,i.length):[]}function f(e){var t=this._events;if(t){var n=t[e];if("function"==typeof n)return 1;if(n)return n.length}return 0}function g(e,t){for(var n=new Array(t),o=0;o<t;++o)n[o]=e[o];return n}s?Object.defineProperty(r,"defaultMaxListeners",{enumerable:!0,get:function(){return d},set:function(e){if("number"!=typeof e||e<0||e!=e)throw new TypeError('"defaultMaxListeners" must be a positive number');d=e}}):r.defaultMaxListeners=d,r.prototype.setMaxListeners=function(e){if("number"!=typeof e||e<0||isNaN(e))throw new TypeError('"n" argument must be a positive number');return this._maxListeners=e,this},r.prototype.getMaxListeners=function(){return l(this)},r.prototype.emit=function(e){var t,n,o,i,a,r,s="error"===e;if(r=this._events)s=s&&null==r.error;else if(!s)return!1;if(s){if(arguments.length>1&&(t=arguments[1]),t instanceof Error)throw t;var d=new Error('Unhandled "error" event. ('+t+")");throw d.context=t,d}if(!(n=r[e]))return!1;var c="function"==typeof n;switch(o=arguments.length){case 1:!function(e,t,n){if(t)e.call(n);else for(var o=e.length,i=g(e,o),a=0;a<o;++a)i[a].call(n)}(n,c,this);break;case 2:!function(e,t,n,o){if(t)e.call(n,o);else for(var i=e.length,a=g(e,i),r=0;r<i;++r)a[r].call(n,o)}(n,c,this,arguments[1]);break;case 3:!function(e,t,n,o,i){if(t)e.call(n,o,i);else for(var a=e.length,r=g(e,a),s=0;s<a;++s)r[s].call(n,o,i)}(n,c,this,arguments[1],arguments[2]);break;case 4:!function(e,t,n,o,i,a){if(t)e.call(n,o,i,a);else for(var r=e.length,s=g(e,r),d=0;d<r;++d)s[d].call(n,o,i,a)}(n,c,this,arguments[1],arguments[2],arguments[3]);break;default:for(i=new Array(o-1),a=1;a<o;a++)i[a-1]=arguments[a];!function(e,t,n,o){if(t)e.apply(n,o);else for(var i=e.length,a=g(e,i),r=0;r<i;++r)a[r].apply(n,o)}(n,c,this,i)}return!0},r.prototype.addListener=function(e,t){return u(this,e,t,!1)},r.prototype.on=r.prototype.addListener,r.prototype.prependListener=function(e,t){return u(this,e,t,!0)},r.prototype.once=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.on(e,p(this,e,t)),this},r.prototype.prependOnceListener=function(e,t){if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');return this.prependListener(e,p(this,e,t)),this},r.prototype.removeListener=function(e,t){var n,i,a,r,s;if("function"!=typeof t)throw new TypeError('"listener" argument must be a function');if(!(i=this._events))return this;if(!(n=i[e]))return this;if(n===t||n.listener===t)0==--this._eventsCount?this._events=o(null):(delete i[e],i.removeListener&&this.emit("removeListener",e,n.listener||t));else if("function"!=typeof n){for(a=-1,r=n.length-1;r>=0;r--)if(n[r]===t||n[r].listener===t){s=n[r].listener,a=r;break}if(a<0)return this;0===a?n.shift():function(e,t){for(var n=t,o=n+1,i=e.length;o<i;n+=1,o+=1)e[n]=e[o];e.pop()}(n,a),1===n.length&&(i[e]=n[0]),i.removeListener&&this.emit("removeListener",e,s||t)}return this},r.prototype.removeAllListeners=function(e){var t,n,a;if(!(n=this._events))return this;if(!n.removeListener)return 0===arguments.length?(this._events=o(null),this._eventsCount=0):n[e]&&(0==--this._eventsCount?this._events=o(null):delete n[e]),this;if(0===arguments.length){var r,s=i(n);for(a=0;a<s.length;++a)"removeListener"!==(r=s[a])&&this.removeAllListeners(r);return this.removeAllListeners("removeListener"),this._events=o(null),this._eventsCount=0,this}if("function"==typeof(t=n[e]))this.removeListener(e,t);else if(t)for(a=t.length-1;a>=0;a--)this.removeListener(e,t[a]);return this},r.prototype.listeners=function(e){return h(this,e,!0)},r.prototype.rawListeners=function(e){return h(this,e,!1)},r.listenerCount=function(e,t){return"function"==typeof e.listenerCount?e.listenerCount(t):f.call(e,t)},r.prototype.listenerCount=f,r.prototype.eventNames=function(){return this._eventsCount>0?Reflect.ownKeys(this._events):[]}},{}],5:[function(e,t,n){"use strict";var o=e("normalice");t.exports=function(t){var n,i={stun:(t||{}).stun||e("./stun.json"),turn:(t||{}).turn||e("./turn.json")},a=(t||{}).stunCount||2,r=(t||{}).turnCount||0;function s(e,t){for(var n,a=[],r=[].concat(i[e]);r.length&&a.length<t;)n=Math.random()*r.length|0,a=a.concat(r.splice(n,1));return a.map((function(t){return"string"==typeof t||t instanceof String?o(e+":"+t):t}))}return n=[].concat(s("stun",a)),r&&(n=n.concat(s("turn",r))),n}},{"./stun.json":6,"./turn.json":7,normalice:12}],6:[function(e,t,n){t.exports=["stun.l.google.com:19302","stun1.l.google.com:19302","stun2.l.google.com:19302","stun3.l.google.com:19302","stun4.l.google.com:19302","stun.ekiga.net","stun.ideasip.com","stun.schlund.de","stun.stunprotocol.org:3478","stun.voiparound.com","stun.voipbuster.com","stun.voipstunt.com","stun.voxgratia.org"]},{}],7:[function(e,t,n){t.exports=[]},{}],8:[function(e,t,n){var o,i=e("wildemitter");"undefined"!=typeof window&&(o=window.AudioContext||window.webkitAudioContext);var a=null;t.exports=function(e,t){var n=new i;if(!o)return n;var r,s,d,c=(t=t||{}).smoothing||.1,l=t.interval||50,u=t.threshold,m=t.play,p=t.history||10,h=!0;a=t.audioContext||a||new o,(d=a.createAnalyser()).fftSize=512,d.smoothingTimeConstant=c,s=new Float32Array(d.frequencyBinCount),e.jquery&&(e=e[0]),e instanceof HTMLAudioElement||e instanceof HTMLVideoElement?(r=a.createMediaElementSource(e),void 0===m&&(m=!0),u=u||-50):(r=a.createMediaStreamSource(e),u=u||-50),r.connect(d),m&&d.connect(a.destination),n.speaking=!1,n.suspend=function(){return a.suspend()},n.resume=function(){return a.resume()},Object.defineProperty(n,"state",{get:function(){return a.state}}),a.onstatechange=function(){n.emit("state_change",a.state)},n.setThreshold=function(e){u=e},n.setInterval=function(e){l=e},n.stop=function(){h=!1,n.emit("volume_change",-100,u),n.speaking&&(n.speaking=!1,n.emit("stopped_speaking")),d.disconnect(),r.disconnect()},n.speakingHistory=[];for(var f=0;f<p;f++)n.speakingHistory.push(0);var g=function(){setTimeout((function(){if(h){var e=function(e,t){var n=-1/0;e.getFloatFrequencyData(t);for(var o=4,i=t.length;o<i;o++)t[o]>n&&t[o]<0&&(n=t[o]);return n}(d,s);n.emit("volume_change",e,u);var t=0;if(e>u&&!n.speaking){for(var o=n.speakingHistory.length-3;o<n.speakingHistory.length;o++)t+=n.speakingHistory[o];t>=2&&(n.speaking=!0,n.emit("speaking"))}else if(e<u&&n.speaking){for(o=0;o<n.speakingHistory.length;o++)t+=n.speakingHistory[o];0==t&&(n.speaking=!1,n.emit("stopped_speaking"))}n.speakingHistory.shift(),n.speakingHistory.push(0+(e>u)),g()}}),l)};return g(),n}},{wildemitter:25}],9:[function(e,t,n){"function"==typeof Object.create?t.exports=function(e,t){t&&(e.super_=t,e.prototype=Object.create(t.prototype,{constructor:{value:e,enumerable:!1,writable:!0,configurable:!0}}))}:t.exports=function(e,t){if(t){e.super_=t;var n=function(){};n.prototype=t.prototype,e.prototype=new n,e.prototype.constructor=e}}},{}],10:[function(e,t,n){},{}],11:[function(e,t,n){!function(e){var n=function(e){return i(!0===e,!1,arguments)};function o(e,t){if("object"!==a(e))return t;for(var n in t)"object"===a(e[n])&&"object"===a(t[n])?e[n]=o(e[n],t[n]):e[n]=t[n];return e}function i(e,t,i){var r=i[0],s=i.length;(e||"object"!==a(r))&&(r={});for(var d=0;d<s;++d){var c=i[d];if("object"===a(c))for(var l in c)if("__proto__"!==l){var u=e?n.clone(c[l]):c[l];r[l]=t?o(r[l],u):u}}return r}function a(e){return{}.toString.call(e).slice(8,-1).toLowerCase()}n.recursive=function(e){return i(!0===e,!0,arguments)},n.clone=function(e){var t,o,i=e,r=a(e);if("array"===r)for(i=[],o=e.length,t=0;t<o;++t)i[t]=n.clone(e[t]);else if("object"===r)for(t in i={},e)i[t]=n.clone(e[t]);return i},e?t.exports=n:window.merge=n}("object"==typeof t&&t&&"object"==typeof t.exports&&t.exports)},{}],12:[function(e,t,n){var o=["stun:","turn:"];t.exports=function(e){var t,n,i=(e||{}).url||e,a={};return"string"==typeof i||i instanceof String?(i=i.trim(),(t=o[o.indexOf(i.slice(0,5))])?(n=(i=i.slice(5)).split("@"),a.username=e.username,a.credential=e.credential,n.length>1&&(i=n[1],n=n[0].split(":"),a.username=n[0],a.credential=(e||{}).credential||n[1]||""),a.url=t+i,a.urls=[a.url],a):e):e}},{}],13:[function(e,t,n){var o=t.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w\/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(e){return e.encoding?"rtpmap:%d %s/%s/%s":e.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(e){return null!=e.address?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%d trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(e){return null!=e.subtype?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:([\w_\/]*) (\S*)(?: (\S*))?/,names:["value","uri","config"],format:function(e){return null!=e.config?"extmap:%s %s %s":"extmap:%s %s"}},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(e){return null!=e.sessionConfig?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation"],format:function(e){var t="candidate:%s %d %s %d %s %d typ %s";return t+=null!=e.raddr?" raddr %s rport %d":"%v%v",t+=null!=e.tcptype?" tcptype %s":"%v",null!=e.generation&&(t+=" generation %d"),t}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_]*):(.*)/,names:["id","attribute","value"],format:"ssrc:%d %s:%s"},{push:"ssrcGroups",reg:/^ssrc-group:(\w*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{push:"invalid",names:["value"]}]};Object.keys(o).forEach((function(e){o[e].forEach((function(e){e.reg||(e.reg=/(.*)/),e.format||(e.format="%s")}))}))},{}],14:[function(e,t,n){var o=e("./parser"),i=e("./writer");n.write=i,n.parse=o.parse,n.parseFmtpConfig=o.parseFmtpConfig,n.parsePayloads=o.parsePayloads,n.parseRemoteCandidates=o.parseRemoteCandidates},{"./parser":15,"./writer":16}],15:[function(e,t,n){var o=function(e){return String(Number(e))===e?Number(e):e},i=function(e,t,n){var i=e.name&&e.names;e.push&&!t[e.push]?t[e.push]=[]:i&&!t[e.name]&&(t[e.name]={});var a=e.push?{}:i?t[e.name]:t;!function(e,t,n,i){if(i&&!n)t[i]=o(e[1]);else for(var a=0;a<n.length;a+=1)null!=e[a+1]&&(t[n[a]]=o(e[a+1]))}(n.match(e.reg),a,e.names,e.name),e.push&&t[e.push].push(a)},a=e("./grammar"),r=RegExp.prototype.test.bind(/^([a-z])=(.*)/);n.parse=function(e){var t={},n=[],o=t;return e.split(/(\r\n|\r|\n)/).filter(r).forEach((function(e){var t=e[0],r=e.slice(2);"m"===t&&(n.push({rtp:[],fmtp:[]}),o=n[n.length-1]);for(var s=0;s<(a[t]||[]).length;s+=1){var d=a[t][s];if(d.reg.test(r))return i(d,o,r)}})),t.media=n,t};var s=function(e,t){var n=t.split("=");return 2===n.length&&(e[n[0]]=o(n[1])),e};n.parseFmtpConfig=function(e){return e.split(/\;\s?/).reduce(s,{})},n.parsePayloads=function(e){return e.split(" ").map(Number)},n.parseRemoteCandidates=function(e){for(var t=[],n=e.split(" ").map(o),i=0;i<n.length;i+=3)t.push({component:n[i],ip:n[i+1],port:n[i+2]});return t}},{"./grammar":13}],16:[function(e,t,n){var o=e("./grammar"),i=/%[sdv%]/g,a=function(e){var t=1,n=arguments,o=n.length;return e.replace(i,(function(e){if(t>=o)return e;var i=n[t];switch(t+=1,e){case"%%":return"%";case"%s":return String(i);case"%d":return Number(i);case"%v":return""}}))},r=function(e,t,n){var o=[e+"="+(t.format instanceof Function?t.format(t.push?n:n[t.name]):t.format)];if(t.names)for(var i=0;i<t.names.length;i+=1){var r=t.names[i];t.name?o.push(n[t.name][r]):o.push(n[t.names[i]])}else o.push(n[t.name]);return a.apply(null,o)},s=["v","o","s","i","u","e","p","c","b","t","r","z","a"],d=["i","c","b","a"];t.exports=function(e,t){t=t||{},null==e.version&&(e.version=0),null==e.name&&(e.name=" "),e.media.forEach((function(e){null==e.payloads&&(e.payloads="")}));var n=t.outerOrder||s,i=t.innerOrder||d,a=[];return n.forEach((function(t){o[t].forEach((function(n){n.name in e&&null!=e[n.name]?a.push(r(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){a.push(r(t,n,e))}))}))})),e.media.forEach((function(e){a.push(r("m",o.m[0],e)),i.forEach((function(t){o[t].forEach((function(n){n.name in e&&null!=e[n.name]?a.push(r(t,n,e)):n.push in e&&null!=e[n.push]&&e[n.push].forEach((function(e){a.push(r(t,n,e))}))}))}))})),a.join("\r\n")+"\r\n"}},{"./grammar":13}],17:[function(e,t,n){t.exports=function e(t){if(!t)return!1;if(this.length!=t.length)return!1;for(var n=0,o=this.length;n<o;n++)if(this[n]instanceof Array&&t[n]instanceof Array){if(!e.apply(this[n],[t[n]]))return!1}else if(this[n]!=t[n])return!1;return!0}},{}],18:[function(e,t,n){n.Interop=e("./interop")},{"./interop":19}],19:[function(e,t,n){"use strict";var o=e("./transform"),i=e("./array-equals");function a(){this.cache={mlB2UMap:{},mlU2BMap:{}}}t.exports=a,a.prototype.candidateToUnifiedPlan=function(e){var t=new RTCIceCandidate(e);return t.sdpMLineIndex=this.cache.mlB2UMap[t.sdpMLineIndex],t},a.prototype.candidateToPlanB=function(e){var t=new RTCIceCandidate(e);if(0===t.sdpMid.indexOf("audio"))t.sdpMid="audio";else{if(0!==t.sdpMid.indexOf("video"))throw new Error("candidate with "+t.sdpMid+" not allowed");t.sdpMid="video"}return t.sdpMLineIndex=this.cache.mlU2BMap[t.sdpMLineIndex],t},a.prototype.getFirstSendingIndexFromAnswer=function(e){if(!this.cache.answer)return null;var t=o.parse(this.cache.answer);if(t&&t.media&&Array.isArray(t.media))for(var n=0;n<t.media.length;n++)if(t.media[n].type==e&&(!t.media[n].direction||"sendrecv"===t.media[n].direction||"sendonly"===t.media[n].direction))return n;return null},a.prototype.toPlanB=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=o.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length<=3&&n.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Unified Plan."),e;for(var i=e.sdp,a=!1,r=0;r<n.media.length;r++){n.media[r].rtp.forEach((function(e){if("NULL"===e.codec){a=!0;var n=o.parse(t.cache.offer);e.codec=n.media[r].rtp[0].codec}}))}a&&(i=o.write(n)),this.cache[e.type]=i;var s=n.media;n.media=[];var d={},c=[];s.forEach((function(e){if(("string"!=typeof e.rtcpMux||"rtcp-mux"!==e.rtcpMux)&&"inactive"!==e.direction)throw new Error("Cannot convert to Plan B because m-lines without the rtcp-mux attribute were found.");if(void 0!==d[e.type]&&"inactive"!==d[e.type].direction||(d[e.type]=e),e.protocol!=d[e.type].protocol)throw new Error("Cannot convert to Plan B because m-lines have different protocols and this library does not have support for that");if(e.payloads!=d[e.type].payloads)throw new Error("Cannot convert to Plan B because m-lines have different payloads and this library does not have support for that")})),s.forEach((function(e){if("application"===e.type)return n.media.push(e),void c.push(e.mid);"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){"object"!=typeof d[e.type].sources&&(d[e.type].sources={}),d[e.type].sources[t]=e.sources[t],void 0!==e.msid&&(d[e.type].sources[t].msid=e.msid)})),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&(void 0!==d[e.type].ssrcGroups&&Array.isArray(d[e.type].ssrcGroups)||(d[e.type].ssrcGroups=[]),d[e.type].ssrcGroups=d[e.type].ssrcGroups.concat(e.ssrcGroups)),d[e.type]===e&&(e.mid=e.type,delete e.bundleOnly,delete e.msid,e.type==s[0].type?(c.unshift(e.type),n.media.unshift(e)):(c.push(e.type),n.media.push(e)))})),void 0!==n.groups&&n.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=c.join(" "),!0})),n.msidSemantic={semantic:"WMS",token:"*"};var l=o.write(n);return new RTCSessionDescription({type:e.type,sdp:l})},a.prototype.toUnifiedPlan=function(e){var t=this;if("object"!=typeof e||null===e||"string"!=typeof e.sdp)return console.warn("An empty description was passed as an argument."),e;var n=o.parse(e.sdp);if(void 0===n.media||!Array.isArray(n.media)||0===n.media.length)return console.warn("The description has no media."),e;if(n.media.length>3||!n.media.every((function(e){return-1!==["video","audio","data"].indexOf(e.mid)})))return console.warn("This description does not look like Plan B."),e;var a=[];n.media.forEach((function(e){a.push(e.mid)}));var r,s,d=!1;if(void 0!==n.groups&&Array.isArray(n.groups)&&(d=n.groups.every((function(e){return"BUNDLE"!==e.type||i.apply(e.mids.sort(),[a.sort()])}))),!d){var c=!1;if(n.media.forEach((function(e){"inactive"!==e.direction&&(c=!0)})),c)throw new Error("Cannot convert to Unified Plan because m-lines that are not bundled were found.")}if("answer"===e.type)r="offer";else{if("offer"!==e.type)throw new Error("Type '"+e.type+"' not supported.");r="answer"}void 0!==this.cache[r]&&(s=o.parse(this.cache[r]));var l,u,m,p,h={audio:{},video:{}},f={},g=0,v=0,y={},_={},w={},b={};if(n.media.forEach((function(n){if(("string"!=typeof n.rtcpMux||"rtcp-mux"!==n.rtcpMux)&&"inactive"!==n.direction)throw new Error("Cannot convert to Unified Plan because m-lines without the rtcp-mux attribute were found.");if("application"!==n.type){var o=n.sources,i=n.ssrcGroups,a=n.port;if(void 0!==n.candidates&&(l=void 0!==l?l.concat(n.candidates):n.candidates),void 0!==u&&void 0!==n.iceUfrag&&u!=n.iceUfrag)throw new Error("Only BUNDLE supported, iceUfrag must be the same for all m-lines.\n\tLast iceUfrag: "+u+"\n\tNew iceUfrag: "+n.iceUfrag);if(void 0!==n.iceUfrag&&(u=n.iceUfrag),void 0!==m&&void 0!==n.icePwd&&m!=n.icePwd)throw new Error("Only BUNDLE supported, icePwd must be the same for all m-lines.\n\tLast icePwd: "+m+"\n\tNew icePwd: "+n.icePwd);if(void 0!==n.icePwd&&(m=n.icePwd),void 0!==p&&void 0!==n.fingerprint&&(p.type!=n.fingerprint.type||p.hash!=n.fingerprint.hash))throw new Error("Only BUNDLE supported, fingerprint must be the same for all m-lines.\n\tLast fingerprint: "+JSON.stringify(p)+"\n\tNew fingerprint: "+JSON.stringify(n.fingerprint));void 0!==n.fingerprint&&(p=n.fingerprint),_[n.type]=n.payloads,w[n.type]=n.rtcpFb,b[n.type]=n.rtp;var r={};void 0!==i&&Array.isArray(i)&&i.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&e.ssrcs.forEach((function(t){void 0===r[t]&&(r[t]=[]),r[t].push(e)}))}));var d={};if("object"==typeof o)delete n.sources,delete n.ssrcGroups,delete n.candidates,delete n.iceUfrag,delete n.icePwd,delete n.fingerprint,delete n.port,delete n.mid,Object.keys(o).forEach((function(i){var c;"offer"!==e.type||o[i].msid?(void 0!==r[i]&&Array.isArray(r[i])&&r[i].some((function(e){return e.ssrcs.some((function(e){if("object"==typeof d[e])return c=d[e],!0}))})),"object"==typeof c?(c.sources[i]=o[i],delete o[i].msid):(c=Object.create(n),d[i]=c,void 0!==o[i].msid&&(c.msid=o[i].msid,delete o[i].msid),c.sources={},c.sources[i]=o[i],c.ssrcGroups=r[i],void 0!==s&&void 0!==s.media&&Array.isArray(s.media)&&s.media.forEach((function(e){"object"==typeof e.sources&&Object.keys(e.sources).forEach((function(t){t===i&&(c.mid=e.mid)}))})),void 0===c.mid&&(c.mid=[n.type,"-",i].join("")),c.candidates=l,c.iceUfrag=u,c.icePwd=m,c.fingerprint=p,c.port=a,f[c.mid]=c,y[v]=c.sources,t.cache.mlU2BMap[v]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=v),v++)):h[n.type][i]=o[i]}));else{var c=n;c.candidates=l,c.iceUfrag=u,c.icePwd=m,c.fingerprint=p,c.port=a,f[c.mid]=c,t.cache.mlU2BMap[v]=g,void 0===t.cache.mlB2UMap[g]&&(t.cache.mlB2UMap[g]=v)}g++}else f[n.mid]=n})),n.media=[],a=[],"answer"===e.type)for(var V=0;V<s.media.length;V++){var k=s.media[V];delete k.msid,delete k.sources,delete k.ssrcGroups,void 0===y[V]?k.direction&&"sendrecv"!==k.direction?"sendonly"===k.direction&&(k.direction="inactive"):k.direction="recvonly":k.direction&&"sendrecv"!==k.direction?"recvonly"===k.direction&&(k.direction="sendonly"):k.direction="sendrecv",k.sources=y[V],k.candidates=l,k.iceUfrag=u,k.icePwd=m,k.fingerprint=p,k.rtp=b[k.type],k.payloads=_[k.type],k.rtcpFb=w[k.type],n.media.push(k),"string"==typeof k.mid&&a.push(k.mid)}else void 0!==s&&void 0!==s.media&&Array.isArray(s.media)&&s.media.forEach((function(e){a.push(e.mid),void 0!==f[e.mid]?n.media.push(f[e.mid]):(delete e.msid,delete e.sources,delete e.ssrcGroups,e.direction&&"sendrecv"!==e.direction||(e.direction="sendonly"),e.direction&&"recvonly"!==e.direction||(e.direction="inactive"),function(e){void 0!==e.setup&&("active"===e.setup?e.setup="passive":"passive"===e.setup&&(e.setup="active"))}(e),n.media.push(e))})),Object.keys(f).forEach((function(e){if(-1===a.indexOf(e))if(a.push(e),"recvonly"===f[e].direction){var t=!1;n.media.some((function(n){if(("sendrecv"===n.direction||"sendonly"===n.direction)&&n.type===f[e].type)return Object.keys(f[e].sources).forEach((function(t){n.sources[t]=f[e].sources[t]})),t=!0,!0})),t||n.media.push(f[e])}else n.media.push(f[e])}));["audio","video"].forEach((function(e){if(n&&n.media&&Array.isArray(n.media)){var o=null;if(Object.keys(h[e]).length>0&&null===(o=t.getFirstSendingIndexFromAnswer(e)))for(var i=0;i<n.media.length;i++)if(n.media[i].type===e){o=i;break}if(o&&n.media.length>o){var a=n.media[o];Object.keys(h[e]).forEach((function(t){a.sources&&a.sources[t]&&console.warn("Replacing an existing SSRC."),a.sources||(a.sources={}),a.sources[t]=h[e][t]}))}}})),void 0!==n.groups&&n.groups.some((function(e){if("BUNDLE"===e.type)return e.mids=a.join(" "),!0})),n.msidSemantic={semantic:"WMS",token:"*"};var A=o.write(n);return this.cache[e.type]=A,new RTCSessionDescription({type:e.type,sdp:A})}},{"./array-equals":17,"./transform":20}],20:[function(e,t,n){var o=e("sdp-transform");n.write=function(e,t){return void 0!==e&&void 0!==e.media&&Array.isArray(e.media)&&e.media.forEach((function(e){void 0!==e.sources&&0!==Object.keys(e.sources).length&&(e.ssrcs=[],Object.keys(e.sources).forEach((function(t){var n=e.sources[t];Object.keys(n).forEach((function(o){e.ssrcs.push({id:t,attribute:o,value:n[o]})}))})),delete e.sources),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.ssrcs=e.ssrcs.join(" "))}))})),void 0!==e&&void 0!==e.groups&&Array.isArray(e.groups)&&e.groups.forEach((function(e){void 0!==e.mids&&Array.isArray(e.mids)&&(e.mids=e.mids.join(" "))})),o.write(e,t)},n.parse=function(e){var t=o.parse(e);return void 0!==t&&void 0!==t.media&&Array.isArray(t.media)&&t.media.forEach((function(e){void 0!==e.ssrcs&&Array.isArray(e.ssrcs)&&(e.sources={},e.ssrcs.forEach((function(t){e.sources[t.id]||(e.sources[t.id]={}),e.sources[t.id][t.attribute]=t.value})),delete e.ssrcs),void 0!==e.ssrcGroups&&Array.isArray(e.ssrcGroups)&&e.ssrcGroups.forEach((function(e){"string"==typeof e.ssrcs&&(e.ssrcs=e.ssrcs.split(" "))}))})),void 0!==t&&void 0!==t.groups&&Array.isArray(t.groups)&&t.groups.forEach((function(e){"string"==typeof e.mids&&(e.mids=e.mids.split(" "))})),t}},{"sdp-transform":14}],21:[function(e,t,n){!function(e,o){"use strict";var i="function",a="undefined",r="object",s="model",d="name",c="type",l="vendor",u="version",m="architecture",p="console",h="mobile",f="tablet",g="smarttv",v="wearable",y={extend:function(e,t){var n={};for(var o in e)t[o]&&t[o].length%2==0?n[o]=t[o].concat(e[o]):n[o]=e[o];return n},has:function(e,t){return"string"==typeof e&&-1!==t.toLowerCase().indexOf(e.toLowerCase())},lowerize:function(e){return e.toLowerCase()},major:function(e){return"string"==typeof e?e.replace(/[^\d\.]/g,"").split(".")[0]:o},trim:function(e){return e.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"")}},_={rgx:function(e,t){for(var n,a,s,d,c,l,u=0;u<t.length&&!c;){var m=t[u],p=t[u+1];for(n=a=0;n<m.length&&!c;)if(c=m[n++].exec(e))for(s=0;s<p.length;s++)l=c[++a],typeof(d=p[s])===r&&d.length>0?2==d.length?typeof d[1]==i?this[d[0]]=d[1].call(this,l):this[d[0]]=d[1]:3==d.length?typeof d[1]!==i||d[1].exec&&d[1].test?this[d[0]]=l?l.replace(d[1],d[2]):o:this[d[0]]=l?d[1].call(this,l,d[2]):o:4==d.length&&(this[d[0]]=l?d[3].call(this,l.replace(d[1],d[2])):o):this[d]=l||o;u+=2}},str:function(e,t){for(var n in t)if(typeof t[n]===r&&t[n].length>0){for(var i=0;i<t[n].length;i++)if(y.has(t[n][i],e))return"?"===n?o:n}else if(y.has(t[n],e))return"?"===n?o:n;return e}},w={browser:{oldsafari:{version:{"1.0":"/8",1.2:"/1",1.3:"/3","2.0":"/412","2.0.2":"/416","2.0.3":"/417","2.0.4":"/419","?":"/"}}},device:{amazon:{model:{"Fire Phone":["SD","KF"]}},sprint:{model:{"Evo Shift 4G":"7373KT"},vendor:{HTC:"APA",Sprint:"Sprint"}}},os:{windows:{version:{ME:"4.90","NT 3.11":"NT3.51","NT 4.0":"NT4.0",2e3:"NT 5.0",XP:["NT 5.1","NT 5.2"],Vista:"NT 6.0",7:"NT 6.1",8:"NT 6.2",8.1:"NT 6.3",10:["NT 6.4","NT 10.0"],RT:"ARM"}}}},b={browser:[[/(opera\smini)\/([\w\.-]+)/i,/(opera\s[mobiletab]+).+version\/([\w\.-]+)/i,/(opera).+version\/([\w\.]+)/i,/(opera)[\/\s]+([\w\.]+)/i],[d,u],[/(opios)[\/\s]+([\w\.]+)/i],[[d,"Opera Mini"],u],[/\s(opr)\/([\w\.]+)/i],[[d,"Opera"],u],[/(kindle)\/([\w\.]+)/i,/(lunascape|maxthon|netfront|jasmine|blazer)[\/\s]?([\w\.]*)/i,/(avant\s|iemobile|slim)(?:browser)?[\/\s]?([\w\.]*)/i,/(bidubrowser|baidubrowser)[\/\s]?([\w\.]+)/i,/(?:ms|\()(ie)\s([\w\.]+)/i,/(rekonq)\/([\w\.]*)/i,/(chromium|flock|rockmelt|midori|epiphany|silk|skyfire|ovibrowser|bolt|iron|vivaldi|iridium|phantomjs|bowser|quark|qupzilla|falkon)\/([\w\.-]+)/i],[d,u],[/(konqueror)\/([\w\.]+)/i],[[d,"Konqueror"],u],[/(trident).+rv[:\s]([\w\.]+).+like\sgecko/i],[[d,"IE"],u],[/(edge|edgios|edga|edg)\/((\d+)?[\w\.]+)/i],[[d,"Edge"],u],[/(yabrowser)\/([\w\.]+)/i],[[d,"Yandex"],u],[/(Avast)\/([\w\.]+)/i],[[d,"Avast Secure Browser"],u],[/(AVG)\/([\w\.]+)/i],[[d,"AVG Secure Browser"],u],[/(puffin)\/([\w\.]+)/i],[[d,"Puffin"],u],[/(focus)\/([\w\.]+)/i],[[d,"Firefox Focus"],u],[/(opt)\/([\w\.]+)/i],[[d,"Opera Touch"],u],[/((?:[\s\/])uc?\s?browser|(?:juc.+)ucweb)[\/\s]?([\w\.]+)/i],[[d,"UCBrowser"],u],[/(comodo_dragon)\/([\w\.]+)/i],[[d,/_/g," "],u],[/(windowswechat qbcore)\/([\w\.]+)/i],[[d,"WeChat(Win) Desktop"],u],[/(micromessenger)\/([\w\.]+)/i],[[d,"WeChat"],u],[/(brave)\/([\w\.]+)/i],[[d,"Brave"],u],[/(qqbrowserlite)\/([\w\.]+)/i],[d,u],[/(QQ)\/([\d\.]+)/i],[d,u],[/m?(qqbrowser)[\/\s]?([\w\.]+)/i],[d,u],[/(baiduboxapp)[\/\s]?([\w\.]+)/i],[d,u],[/(2345Explorer)[\/\s]?([\w\.]+)/i],[d,u],[/(MetaSr)[\/\s]?([\w\.]+)/i],[d],[/(LBBROWSER)/i],[d],[/xiaomi\/miuibrowser\/([\w\.]+)/i],[u,[d,"MIUI Browser"]],[/;fbav\/([\w\.]+);/i],[u,[d,"Facebook"]],[/safari\s(line)\/([\w\.]+)/i,/android.+(line)\/([\w\.]+)\/iab/i],[d,u],[/headlesschrome(?:\/([\w\.]+)|\s)/i],[u,[d,"Chrome Headless"]],[/\swv\).+(chrome)\/([\w\.]+)/i],[[d,/(.+)/,"$1 WebView"],u],[/((?:oculus|samsung)browser)\/([\w\.]+)/i],[[d,/(.+(?:g|us))(.+)/,"$1 $2"],u],[/android.+version\/([\w\.]+)\s+(?:mobile\s?safari|safari)*/i],[u,[d,"Android Browser"]],[/(sailfishbrowser)\/([\w\.]+)/i],[[d,"Sailfish Browser"],u],[/(chrome|omniweb|arora|[tizenoka]{5}\s?browser)\/v?([\w\.]+)/i],[d,u],[/(dolfin)\/([\w\.]+)/i],[[d,"Dolphin"],u],[/(qihu|qhbrowser|qihoobrowser|360browser)/i],[[d,"360 Browser"]],[/((?:android.+)crmo|crios)\/([\w\.]+)/i],[[d,"Chrome"],u],[/(coast)\/([\w\.]+)/i],[[d,"Opera Coast"],u],[/fxios\/([\w\.-]+)/i],[u,[d,"Firefox"]],[/version\/([\w\.]+).+?mobile\/\w+\s(safari)/i],[u,[d,"Mobile Safari"]],[/version\/([\w\.]+).+?(mobile\s?safari|safari)/i],[u,d],[/webkit.+?(gsa)\/([\w\.]+).+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[[d,"GSA"],u],[/webkit.+?(mobile\s?safari|safari)(\/[\w\.]+)/i],[d,[u,_.str,w.browser.oldsafari.version]],[/(webkit|khtml)\/([\w\.]+)/i],[d,u],[/(navigator|netscape)\/([\w\.-]+)/i],[[d,"Netscape"],u],[/(swiftfox)/i,/(icedragon|iceweasel|camino|chimera|fennec|maemo\sbrowser|minimo|conkeror)[\/\s]?([\w\.\+]+)/i,/(firefox|seamonkey|k-meleon|icecat|iceape|firebird|phoenix|palemoon|basilisk|waterfox)\/([\w\.-]+)$/i,/(mozilla)\/([\w\.]+).+rv\:.+gecko\/\d+/i,/(polaris|lynx|dillo|icab|doris|amaya|w3m|netsurf|sleipnir)[\/\s]?([\w\.]+)/i,/(links)\s\(([\w\.]+)/i,/(gobrowser)\/?([\w\.]*)/i,/(ice\s?browser)\/v?([\w\._]+)/i,/(mosaic)[\/\s]([\w\.]+)/i],[d,u]],cpu:[[/(?:(amd|x(?:(?:86|64)[_-])?|wow|win)64)[;\)]/i],[[m,"amd64"]],[/(ia32(?=;))/i],[[m,y.lowerize]],[/((?:i[346]|x)86)[;\)]/i],[[m,"ia32"]],[/windows\s(ce|mobile);\sppc;/i],[[m,"arm"]],[/((?:ppc|powerpc)(?:64)?)(?:\smac|;|\))/i],[[m,/ower/,"",y.lowerize]],[/(sun4\w)[;\)]/i],[[m,"sparc"]],[/((?:avr32|ia64(?=;))|68k(?=\))|arm(?:64|(?=v\d+[;l]))|(?=atmel\s)avr|(?:irix|mips|sparc)(?:64)?(?=;)|pa-risc)/i],[[m,y.lowerize]]],device:[[/\((ipad|playbook);[\w\s\),;-]+(rim|apple)/i],[s,l,[c,f]],[/applecoremedia\/[\w\.]+ \((ipad)/],[s,[l,"Apple"],[c,f]],[/(apple\s{0,1}tv)/i],[[s,"Apple TV"],[l,"Apple"],[c,g]],[/(archos)\s(gamepad2?)/i,/(hp).+(touchpad)/i,/(hp).+(tablet)/i,/(kindle)\/([\w\.]+)/i,/\s(nook)[\w\s]+build\/(\w+)/i,/(dell)\s(strea[kpr\s\d]*[\dko])/i],[l,s,[c,f]],[/(kf[A-z]+)\sbuild\/.+silk\//i],[s,[l,"Amazon"],[c,f]],[/(sd|kf)[0349hijorstuw]+\sbuild\/.+silk\//i],[[s,_.str,w.device.amazon.model],[l,"Amazon"],[c,h]],[/android.+aft([bms])\sbuild/i],[s,[l,"Amazon"],[c,g]],[/\((ip[honed|\s\w*]+);.+(apple)/i],[s,l,[c,h]],[/\((ip[honed|\s\w*]+);/i],[s,[l,"Apple"],[c,h]],[/(blackberry)[\s-]?(\w+)/i,/(blackberry|benq|palm(?=\-)|sonyericsson|acer|asus|dell|meizu|motorola|polytron)[\s_-]?([\w-]*)/i,/(hp)\s([\w\s]+\w)/i,/(asus)-?(\w+)/i],[l,s,[c,h]],[/\(bb10;\s(\w+)/i],[s,[l,"BlackBerry"],[c,h]],[/android.+(transfo[prime\s]{4,10}\s\w+|eeepc|slider\s\w+|nexus 7|padfone|p00c)/i],[s,[l,"Asus"],[c,f]],[/(sony)\s(tablet\s[ps])\sbuild\//i,/(sony)?(?:sgp.+)\sbuild\//i],[[l,"Sony"],[s,"Xperia Tablet"],[c,f]],[/android.+\s([c-g]\d{4}|so[-l]\w+)(?=\sbuild\/|\).+chrome\/(?![1-6]{0,1}\d\.))/i],[s,[l,"Sony"],[c,h]],[/\s(ouya)\s/i,/(nintendo)\s([wids3u]+)/i],[l,s,[c,p]],[/android.+;\s(shield)\sbuild/i],[s,[l,"Nvidia"],[c,p]],[/(playstation\s[34portablevi]+)/i],[s,[l,"Sony"],[c,p]],[/(sprint\s(\w+))/i],[[l,_.str,w.device.sprint.vendor],[s,_.str,w.device.sprint.model],[c,h]],[/(htc)[;_\s-]+([\w\s]+(?=\)|\sbuild)|\w+)/i,/(zte)-(\w*)/i,/(alcatel|geeksphone|nexian|panasonic|(?=;\s)sony)[_\s-]?([\w-]*)/i],[l,[s,/_/g," "],[c,h]],[/(nexus\s9)/i],[s,[l,"HTC"],[c,f]],[/d\/huawei([\w\s-]+)[;\)]/i,/(nexus\s6p|vog-l29|ane-lx1|eml-l29|ele-l29)/i],[s,[l,"Huawei"],[c,h]],[/android.+(bah2?-a?[lw]\d{2})/i],[s,[l,"Huawei"],[c,f]],[/(microsoft);\s(lumia[\s\w]+)/i],[l,s,[c,h]],[/[\s\(;](xbox(?:\sone)?)[\s\);]/i],[s,[l,"Microsoft"],[c,p]],[/(kin\.[onetw]{3})/i],[[s,/\./g," "],[l,"Microsoft"],[c,h]],[/\s(milestone|droid(?:[2-4x]|\s(?:bionic|x2|pro|razr))?:?(\s4g)?)[\w\s]+build\//i,/mot[\s-]?(\w*)/i,/(XT\d{3,4}) build\//i,/(nexus\s6)/i],[s,[l,"Motorola"],[c,h]],[/android.+\s(mz60\d|xoom[\s2]{0,2})\sbuild\//i],[s,[l,"Motorola"],[c,f]],[/hbbtv\/\d+\.\d+\.\d+\s+\([\w\s]*;\s*(\w[^;]*);([^;]*)/i],[[l,y.trim],[s,y.trim],[c,g]],[/hbbtv.+maple;(\d+)/i],[[s,/^/,"SmartTV"],[l,"Samsung"],[c,g]],[/\(dtv[\);].+(aquos)/i],[s,[l,"Sharp"],[c,g]],[/android.+((sch-i[89]0\d|shw-m380s|gt-p\d{4}|gt-n\d+|sgh-t8[56]9|nexus 10))/i,/((SM-T\w+))/i],[[l,"Samsung"],s,[c,f]],[/smart-tv.+(samsung)/i],[l,[c,g],s],[/((s[cgp]h-\w+|gt-\w+|galaxy\snexus|sm-\w[\w\d]+))/i,/(sam[sung]*)[\s-]*(\w+-?[\w-]*)/i,/sec-((sgh\w+))/i],[[l,"Samsung"],s,[c,h]],[/sie-(\w*)/i],[s,[l,"Siemens"],[c,h]],[/(maemo|nokia).*(n900|lumia\s\d+)/i,/(nokia)[\s_-]?([\w-]*)/i],[[l,"Nokia"],s,[c,h]],[/android[x\d\.\s;]+\s([ab][1-7]\-?[0178a]\d\d?)/i],[s,[l,"Acer"],[c,f]],[/android.+([vl]k\-?\d{3})\s+build/i],[s,[l,"LG"],[c,f]],[/android\s3\.[\s\w;-]{10}(lg?)-([06cv9]{3,4})/i],[[l,"LG"],s,[c,f]],[/(lg) netcast\.tv/i],[l,s,[c,g]],[/(nexus\s[45])/i,/lg[e;\s\/-]+(\w*)/i,/android.+lg(\-?[\d\w]+)\s+build/i],[s,[l,"LG"],[c,h]],[/(lenovo)\s?(s(?:5000|6000)(?:[\w-]+)|tab(?:[\s\w]+))/i],[l,s,[c,f]],[/android.+(ideatab[a-z0-9\-\s]+)/i],[s,[l,"Lenovo"],[c,f]],[/(lenovo)[_\s-]?([\w-]+)/i],[l,s,[c,h]],[/linux;.+((jolla));/i],[l,s,[c,h]],[/((pebble))app\/[\d\.]+\s/i],[l,s,[c,v]],[/android.+;\s(oppo)\s?([\w\s]+)\sbuild/i],[l,s,[c,h]],[/crkey/i],[[s,"Chromecast"],[l,"Google"],[c,g]],[/android.+;\s(glass)\s\d/i],[s,[l,"Google"],[c,v]],[/android.+;\s(pixel c)[\s)]/i],[s,[l,"Google"],[c,f]],[/android.+;\s(pixel( [23])?( xl)?)[\s)]/i],[s,[l,"Google"],[c,h]],[/android.+;\s(\w+)\s+build\/hm\1/i,/android.+(hm[\s\-_]*note?[\s_]*(?:\d\w)?)\s+build/i,/android.+(mi[\s\-_]*(?:a\d|one|one[\s_]plus|note lte)?[\s_]*(?:\d?\w?)[\s_]*(?:plus)?)\s+build/i,/android.+(redmi[\s\-_]*(?:note)?(?:[\s_]?[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[c,h]],[/android.+(mi[\s\-_]*(?:pad)(?:[\s_]?[\w\s]+))\s+build/i],[[s,/_/g," "],[l,"Xiaomi"],[c,f]],[/android.+;\s(m[1-5]\snote)\sbuild/i],[s,[l,"Meizu"],[c,h]],[/(mz)-([\w-]{2,})/i],[[l,"Meizu"],s,[c,h]],[/android.+a000(1)\s+build/i,/android.+oneplus\s(a\d{4})[\s)]/i],[s,[l,"OnePlus"],[c,h]],[/android.+[;\/]\s*(RCT[\d\w]+)\s+build/i],[s,[l,"RCA"],[c,f]],[/android.+[;\/\s]+(Venue[\d\s]{2,7})\s+build/i],[s,[l,"Dell"],[c,f]],[/android.+[;\/]\s*(Q[T|M][\d\w]+)\s+build/i],[s,[l,"Verizon"],[c,f]],[/android.+[;\/]\s+(Barnes[&\s]+Noble\s+|BN[RT])(V?.*)\s+build/i],[[l,"Barnes & Noble"],s,[c,f]],[/android.+[;\/]\s+(TM\d{3}.*\b)\s+build/i],[s,[l,"NuVision"],[c,f]],[/android.+;\s(k88)\sbuild/i],[s,[l,"ZTE"],[c,f]],[/android.+[;\/]\s*(gen\d{3})\s+build.*49h/i],[s,[l,"Swiss"],[c,h]],[/android.+[;\/]\s*(zur\d{3})\s+build/i],[s,[l,"Swiss"],[c,f]],[/android.+[;\/]\s*((Zeki)?TB.*\b)\s+build/i],[s,[l,"Zeki"],[c,f]],[/(android).+[;\/]\s+([YR]\d{2})\s+build/i,/android.+[;\/]\s+(Dragon[\-\s]+Touch\s+|DT)(\w{5})\sbuild/i],[[l,"Dragon Touch"],s,[c,f]],[/android.+[;\/]\s*(NS-?\w{0,9})\sbuild/i],[s,[l,"Insignia"],[c,f]],[/android.+[;\/]\s*((NX|Next)-?\w{0,9})\s+build/i],[s,[l,"NextBook"],[c,f]],[/android.+[;\/]\s*(Xtreme\_)?(V(1[045]|2[015]|30|40|60|7[05]|90))\s+build/i],[[l,"Voice"],s,[c,h]],[/android.+[;\/]\s*(LVTEL\-)?(V1[12])\s+build/i],[[l,"LvTel"],s,[c,h]],[/android.+;\s(PH-1)\s/i],[s,[l,"Essential"],[c,h]],[/android.+[;\/]\s*(V(100MD|700NA|7011|917G).*\b)\s+build/i],[s,[l,"Envizen"],[c,f]],[/android.+[;\/]\s*(Le[\s\-]+Pan)[\s\-]+(\w{1,9})\s+build/i],[l,s,[c,f]],[/android.+[;\/]\s*(Trio[\s\-]*.*)\s+build/i],[s,[l,"MachSpeed"],[c,f]],[/android.+[;\/]\s*(Trinity)[\-\s]*(T\d{3})\s+build/i],[l,s,[c,f]],[/android.+[;\/]\s*TU_(1491)\s+build/i],[s,[l,"Rotor"],[c,f]],[/android.+(KS(.+))\s+build/i],[s,[l,"Amazon"],[c,f]],[/android.+(Gigaset)[\s\-]+(Q\w{1,9})\s+build/i],[l,s,[c,f]],[/\s(tablet|tab)[;\/]/i,/\s(mobile)(?:[;\/]|\ssafari)/i],[[c,y.lowerize],l,s],[/[\s\/\(](smart-?tv)[;\)]/i],[[c,g]],[/(android[\w\.\s\-]{0,9});.+build/i],[s,[l,"Generic"]]],engine:[[/windows.+\sedge\/([\w\.]+)/i],[u,[d,"EdgeHTML"]],[/webkit\/537\.36.+chrome\/(?!27)([\w\.]+)/i],[u,[d,"Blink"]],[/(presto)\/([\w\.]+)/i,/(webkit|trident|netfront|netsurf|amaya|lynx|w3m|goanna)\/([\w\.]+)/i,/(khtml|tasman|links)[\/\s]\(?([\w\.]+)/i,/(icab)[\/\s]([23]\.[\d\.]+)/i],[d,u],[/rv\:([\w\.]{1,9}).+(gecko)/i],[u,d]],os:[[/microsoft\s(windows)\s(vista|xp)/i],[d,u],[/(windows)\snt\s6\.2;\s(arm)/i,/(windows\sphone(?:\sos)*)[\s\/]?([\d\.\s\w]*)/i,/(windows\smobile|windows)[\s\/]?([ntce\d\.\s]+\w)/i],[d,[u,_.str,w.os.windows.version]],[/(win(?=3|9|n)|win\s9x\s)([nt\d\.]+)/i],[[d,"Windows"],[u,_.str,w.os.windows.version]],[/\((bb)(10);/i],[[d,"BlackBerry"],u],[/(blackberry)\w*\/?([\w\.]*)/i,/(tizen|kaios)[\/\s]([\w\.]+)/i,/(android|webos|palm\sos|qnx|bada|rim\stablet\sos|meego|sailfish|contiki)[\/\s-]?([\w\.]*)/i],[d,u],[/(symbian\s?os|symbos|s60(?=;))[\/\s-]?([\w\.]*)/i],[[d,"Symbian"],u],[/\((series40);/i],[d],[/mozilla.+\(mobile;.+gecko.+firefox/i],[[d,"Firefox OS"],u],[/(nintendo|playstation)\s([wids34portablevu]+)/i,/(mint)[\/\s\(]?(\w*)/i,/(mageia|vectorlinux)[;\s]/i,/(joli|[kxln]?ubuntu|debian|suse|opensuse|gentoo|(?=\s)arch|slackware|fedora|mandriva|centos|pclinuxos|redhat|zenwalk|linpus)[\/\s-]?(?!chrom)([\w\.-]*)/i,/(hurd|linux)\s?([\w\.]*)/i,/(gnu)\s?([\w\.]*)/i],[d,u],[/(cros)\s[\w]+\s([\w\.]+\w)/i],[[d,"Chromium OS"],u],[/(sunos)\s?([\w\.\d]*)/i],[[d,"Solaris"],u],[/\s([frentopc-]{0,4}bsd|dragonfly)\s?([\w\.]*)/i],[d,u],[/(haiku)\s(\w+)/i],[d,u],[/cfnetwork\/.+darwin/i,/ip[honead]{2,4}(?:.*os\s([\w]+)\slike\smac|;\sopera)/i],[[u,/_/g,"."],[d,"iOS"]],[/(mac\sos\sx)\s?([\w\s\.]*)/i,/(macintosh|mac(?=_powerpc)\s)/i],[[d,"Mac OS"],[u,/_/g,"."]],[/((?:open)?solaris)[\/\s-]?([\w\.]*)/i,/(aix)\s((\d)(?=\.|\)|\s)[\w\.])*/i,/(plan\s9|minix|beos|os\/2|amigaos|morphos|risc\sos|openvms|fuchsia)/i,/(unix)\s?([\w\.]*)/i],[d,u]]},V=function(t,n){if("object"==typeof t&&(n=t,t=o),!(this instanceof V))return new V(t,n).getResult();var i=t||(e&&e.navigator&&e.navigator.userAgent?e.navigator.userAgent:""),a=n?y.extend(b,n):b;return this.getBrowser=function(){var e={name:o,version:o};return _.rgx.call(e,i,a.browser),e.major=y.major(e.version),e},this.getCPU=function(){var e={architecture:o};return _.rgx.call(e,i,a.cpu),e},this.getDevice=function(){var e={vendor:o,model:o,type:o};return _.rgx.call(e,i,a.device),e},this.getEngine=function(){var e={name:o,version:o};return _.rgx.call(e,i,a.engine),e},this.getOS=function(){var e={name:o,version:o};return _.rgx.call(e,i,a.os),e},this.getResult=function(){return{ua:this.getUA(),browser:this.getBrowser(),engine:this.getEngine(),os:this.getOS(),device:this.getDevice(),cpu:this.getCPU()}},this.getUA=function(){return i},this.setUA=function(e){return i=e,this},this};V.VERSION="0.7.22",V.BROWSER={NAME:d,MAJOR:"major",VERSION:u},V.CPU={ARCHITECTURE:m},V.DEVICE={MODEL:s,VENDOR:l,TYPE:c,CONSOLE:p,MOBILE:h,SMARTTV:g,TABLET:f,WEARABLE:v,EMBEDDED:"embedded"},V.ENGINE={NAME:d,VERSION:u},V.OS={NAME:d,VERSION:u},typeof n!==a?(typeof t!==a&&t.exports&&(n=t.exports=V),n.UAParser=V):e&&(e.UAParser=V);var k=e&&(e.jQuery||e.Zepto);if(k&&!k.ua){var A=new V;k.ua=A.getResult(),k.ua.get=function(){return A.getUA()},k.ua.set=function(e){A.setUA(e);var t=A.getResult();for(var n in t)k.ua[n]=t[n]}}}("object"==typeof window?window:this)},{}],22:[function(e,t,n){for(var o=[],i=0;i<256;++i)o[i]=(i+256).toString(16).substr(1);t.exports=function(e,t){var n=t||0,i=o;return[i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],"-",i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]],i[e[n++]]].join("")}},{}],23:[function(e,t,n){var o="undefined"!=typeof crypto&&crypto.getRandomValues&&crypto.getRandomValues.bind(crypto)||"undefined"!=typeof msCrypto&&"function"==typeof window.msCrypto.getRandomValues&&msCrypto.getRandomValues.bind(msCrypto);if(o){var i=new Uint8Array(16);t.exports=function(){return o(i),i}}else{var a=new Array(16);t.exports=function(){for(var e,t=0;t<16;t++)0==(3&t)&&(e=4294967296*Math.random()),a[t]=e>>>((3&t)<<3)&255;return a}}},{}],24:[function(e,t,n){var o=e("./lib/rng"),i=e("./lib/bytesToUuid");t.exports=function(e,t,n){var a=t&&n||0;"string"==typeof e&&(t="binary"===e?new Array(16):null,e=null);var r=(e=e||{}).random||(e.rng||o)();if(r[6]=15&r[6]|64,r[8]=63&r[8]|128,t)for(var s=0;s<16;++s)t[a+s]=r[s];return t||i(r)}},{"./lib/bytesToUuid":22,"./lib/rng":23}],25:[function(e,t,n){function o(){}t.exports=o,o.mixin=function(e){var t=e.prototype||e;t.isWildEmitter=!0,t.on=function(e,t,n){this.callbacks=this.callbacks||{};var o=3===arguments.length,i=o?arguments[1]:void 0,a=o?arguments[2]:arguments[1];return a._groupName=i,(this.callbacks[e]=this.callbacks[e]||[]).push(a),this},t.once=function(e,t,n){var o=this,i=3===arguments.length,a=i?arguments[1]:void 0,r=i?arguments[2]:arguments[1];return this.on(e,a,(function t(){o.off(e,t),r.apply(this,arguments)})),this},t.releaseGroup=function(e){var t,n,o,i;for(t in this.callbacks=this.callbacks||{},this.callbacks)for(n=0,o=(i=this.callbacks[t]).length;n<o;n++)i[n]._groupName===e&&(i.splice(n,1),n--,o--);return this},t.off=function(e,t){this.callbacks=this.callbacks||{};var n,o=this.callbacks[e];return o?1===arguments.length?(delete this.callbacks[e],this):(-1!==(n=o.indexOf(t))&&(o.splice(n,1),0===o.length&&delete this.callbacks[e]),this):this},t.emit=function(e){this.callbacks=this.callbacks||{};var t,n,o,i=[].slice.call(arguments,1),a=this.callbacks[e],r=this.getWildcardCallbacks(e);if(a)for(t=0,n=(o=a.slice()).length;t<n&&o[t];++t)o[t].apply(this,i);if(r)for(n=r.length,t=0,n=(o=r.slice()).length;t<n&&o[t];++t)o[t].apply(this,[e].concat(i));return this},t.getWildcardCallbacks=function(e){this.callbacks=this.callbacks||{};var t,n,o=[];for(t in this.callbacks)n=t.split("*"),("*"===t||2===n.length&&e.slice(0,n[0].length)===n[0])&&(o=o.concat(this.callbacks[t]));return o}},o.mixin(o)},{}]},{},[2])(2)}));var mod1,mod2,mod5,mod8,curIP="",aonly=1,cam1=(altlang=["en","ru","es","fr","cn","pt"],getCookie("d1")),cam2=getCookie("d2"),scanned=getCookie("s1");const soundEffect=new Audio;soundEffect.autoplay=!0;var ch_int,chr_int,snd_clicked=!1,dummies=!1,oldColor=null,selectedFile=null,movieList_names=[],loado="",warning="",waiter="",sorry="",hola="",caller="",requ="",creatu="",badger="",learner="",morer="",hea="",now="",today="",roo="",buy="",helpcapo="",chat_shown=1,temporary=0,cammode=0,stats_shown=1,sp_shown=(window==window.top&&(w[0].match(new RegExp("skypirl","g"))||w[0].match(new RegExp("club","g"))||w[0].match(new RegExp("milan","g"))),0),voting_shown=(w[0],0),sound_on_played="club"===w[0]||w[0].match(new RegExp("rgsu","g"))?1:0,scrolled=!1,heard_info=getCookie("heard_info")||!1,who_to="",already_clicked=!1,afterBinding=!1,curSelInd=0,curMoviesList=[],curMovie="",switched=!1,lori=!!(small_device&&window.innerWidth>window.innerHeight);function getIP(e){curIP=e.ip,document.id("curip").value=curIP}function ajax_chat(){fetch("https://"+window.location.hostname+port+"/log.html").then((e=>e.text())).then((e=>{document.id("message_box").innerHTML=e})).catch((e=>console.log(e)))}function ajax_room(e){let t="REDHALL"==e?"red_hall_span":"BLUEHALL"==e?"blue_hall_span":"GREENHALL"==e?"green_hall_span":"";0!=t.length&&fetch("https://"+window.location.hostname+"/cgi/genc/get_room_data.pl?room="+e).then((e=>e.text())).then((e=>{e.length?document.id(t).innerHTML='"'+e+'"':document.id(t).innerHTML="-"})).catch((e=>console.log(e)))}function change_lang(e){document.id("head1")&&(document.id("head1").innerHTML=heads1.get(e)),document.id("abouter")&&(document.id("abouter").innerHTML=about.get(e)),document.id("helper")&&(document.id("helper").innerHTML=help.get(e)),document.id("leftlab")&&(document.id("leftlab").innerHTML=left_label.get(e)),document.id("rightlab")&&(document.id("rightlab").innerHTML=right_label.get(e)),document.id("dummy_p")&&(document.id("dummy_p").innerHTML=du_.get(e)),document.id("dummy2_p")&&(document.id("dummy2_p").innerHTML=du2_.get(e)),warning=warner.get(e),waiter=waiter_.get(e),sorry=sorry_.get(e),loado=loado_.get(e),caller=caller_.get(e),requ=requ_.get(e),creatu=creatu_.get(e),badger=badger_.get(e),learner=learner_.get(e),morer=morer_.get(e),hea=hea_.get(e),now=now_.get(e),today=today_.get(e),roo=(roo=roo_.get(e)).match(new RegExp("room-house","g"))?"":roo,null!=mod1&&(mod1.content.innerHTML=about_content.get(e)),null!=mod2&&(mod2.content.innerHTML=help_content.get(e)),"undefined"!=typeof mod3&&null!==mod3&&(mod3.content.innerHTML=left_content.get(e)),"undefined"!=typeof mod4&&null!==mod4&&(mod4.content.innerHTML=right_content.get(e))}function checkWebRTC(){var e=navigator.getUserMedia||navigator.webkitGetUserMedia||navigator.mozGetUserMedia||navigator.msGetUserMedia||window.RTCPeerConnection;if(window.navigator.userAgent.indexOf("Edge")>-1||!e)return alert("Please use a different browser with WebRTC support!"),console.log("Bad WebRTC non-compatible bro"),!1;try{(new RTCPeerConnection).addTransceiver("audio")}catch(e){console.log(e),alert("Please use a newer browser with full WebRTC support!")}}function toggleHeader(e){1==e&&aonly&&(document.id("room-header").style.color="rgb(153, 204, 255)"==document.id("room-header").style.color?oldColor:"#9cf",document.id("room-header-file").style.display="block"==document.id("room-header-file").style.display?"none":"block",setCookie("player",playSomeMusic=1!=playSomeMusic)),2==e&&aonly&&(document.id("room-header-file").style.display="none",document.id("room-header").style.color="rgb(153, 255, 204)"==document.id("room-header").style.color?oldColor:"#9fc",shareSomeScreen=1!=shareSomeScreen,setCookie("player",""))}function getFile(){let e=document.id("room-header-file").files[curSelInd];selectedFile&&URL.revokeObjectURL(selectedFile),selectedFile=URL.createObjectURL(e)}function getList_names(){movieList_names=[];let e=document.id("room-header-file").files;for(var t=0;t<e.length;t++)movieList_names.push(e[t].name);let n={id:"moviesList",listStr:JSON.stringify(movieList_names),token:getCookie("authtoken")||"",addr:document.id("name").value,curSel:curSelInd};sendMessage(n)}function clearAllCookies(){for(var e=document.cookie.split(";"),t=0;t<e.length;t++){for(var n=e[t],o=n.indexOf("="),i=o>-1?n.substr(0,o):n;" "==i.charAt(0);)i=i.substring(1,i.length);document.cookie=i+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;SameSite=None;Secure;"}"undefined"!=typeof Storage&&localStorage.clear()}function flashText(e,t){let n=t||1e3;document.id("phones").innerHTML=e,document.id("phones").fade(1),function(){document.id("phones").fade(0)}.delay(n)}function flashText_and_rejoin(e){document.id("room-header").style.display="none",document.id("room-header").fade(0),document.id("phones").innerHTML=e,document.id("phones").fade(1),leaveRoom(),register(),function(){document.id("phones").fade(0)}.delay(1e3)}function resizer(e){}function toggleAllMuted(){let e=getCookie("all_muted")||!1,t=loadData(document.id("name").value+"_muted");if(i_am_muted||"bigO my_mic_on_all_off"!=document.id("all_muter").className){if(i_am_muted||"bigO allmuter_on"!=document.id("all_muter").className){let o=!e,i=e?"UNMUTED":"MUTED ALL";if(!0!==t&&"true"!==t||e?setCookie("all_muted",o,1440):(saveData(document.id("name").value+"_muted",!1,1440),i_am_muted=!1,i="MICROPHONE ON"),!1===o&&(saveData(document.id("name").value+"_muted",!1,1440),i_am_muted=!1),document.id("all_muter").title=e?"Turn on sound":"Turn off all sound",Object.keys(participants).length)for(var n in participants)if(participants[n].name!=document.id("name").value){let e=participants[n].name+"_muted";"undefined"!=typeof Storage?localStorage.removeItem(e):document.cookie=e+"=;expires=Thu, 01 Jan 1970 00:00:00 GMT;SameSite=None;Secure;";document.id("video-"+participants[n].name)}flashText_and_rejoin(i)}else if(document.id("all_muter").className="bigO my_mic_on_all_off",document.id("all_muter").title="Turn on sound",Object.keys(participants).length)for(var n in participants){let e=document.id("video-"+participants[n].name),t=document.id("speaker-"+participants[n].name);participants[n].name!=document.id("name").value&&(e.muted=!0,e.volume=0,t.removeChild(t.childNodes[0]),"m"!==participants[n].mode&&t.appendChild(document.createTextNode("🔇")),"m"===participants[n].mode&&t.appendChild(document.createTextNode("X")))}}else if(document.id("all_muter").className="bigO allmuter_on",document.id("all_muter").title="Turn off sound",setCookie("all_muted",!1,1440),Object.keys(participants).length)for(var n in participants){let e=document.id("video-"+participants[n].name),t=document.id("speaker-"+participants[n].name);participants[n].name!=document.id("name").value&&(e.muted=!1,e.volume=1,t.removeChild(t.childNodes[0]),"m"!==participants[n].mode&&t.appendChild(document.createTextNode("🔊")),"m"===participants[n].mode&&t.appendChild(document.createTextNode("X")))}}window.addEventListener("message",(function(e){let t=e.data;if(void 0!==t[0]&&"esms"!=t[0]&&(e.origin=="https://"+window.location.hostname+":18443"||e.origin=="https://"+window.location.hostname+port||e.origin==sp_container_url||e.origin==sp_setter_url||e.origin==sm_url||"https://room-house.com"==e.origin||e.origin==chess_url||e.origin==poker_url||e.origin==air_url||e.origin==swap_url)){if(e.origin=="https://"+window.location.hostname+port||e.origin=="https://"+window.location.hostname+":18443"){if((a=JSON.parse(t)).replacer&&a.replacer.length){var n=window.location.hostname.split("."),o=document.location.href.split("#"),i=o[1]&&o[1].length?o[1]:n[0];console.log("replaced",i,"with",a.replacer,"in",document.location.href),document.id("phones").style.display="none",document.id("container").style.display="none",i==n[0]?document.location.href=document.location.href.replace(i,a.replacer):(history.pushState({},null,document.location.href.replace(i,a.replacer)),window.location.reload())}soundEffect.src="data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV";const e=()=>{(function(){document.id("red_banner")&&("none"==document.id("red_banner").style.display?(document.id("red_banner").style.display="block",document.id("red_banner").fade(1)):(document.id("red_banner").fade(0),function(){document.id("red_banner").style.display="none"}.delay(500)))}).delay(100),function(){document.id("green_banner")&&("none"==document.id("green_banner").style.display?(document.id("green_banner").style.display="block",document.id("green_banner").fade(1)):(document.id("green_banner").fade(0),function(){document.id("green_banner").style.display="none"}.delay(500)))}.delay(100),function(){document.id("blue_banner")&&("none"==document.id("blue_banner").style.display?(document.id("blue_banner").style.display="block",document.id("blue_banner").fade(1)):(document.id("blue_banner").fade(0),function(){document.id("blue_banner").style.display="none"}.delay(500)))}.delay(100),setTimeout((function(){ajax_room("BLUEHALL"),ajax_room("GREENHALL"),ajax_room("REDHALL")}),1e3),chr_int=setInterval((function(){document.id("ph_b")&&"visible"==document.id("ph_b").style.visibility&&homee==w[0]&&(ajax_room("BLUEHALL"),ajax_room("GREENHALL"),ajax_room("REDHALL"))}),3e4)},r=()=>{if(document.id("cont")&&document.id("cont").fade(0),document.id("badge")&&document.id("badge").fade(0),document.id("learn_more")&&document.id("learn_more").fade(0),document.id("socs")&&document.id("socs").fade(0),document.id("hea")&&document.id("hea").fade(0),document.id("bstats")&&document.id("bstats").fade(0),normal_mode){document.id("main_container").style.marginTop="-60px";let e="REDHALL"==homee?"red":"BLUEHALL"==homee?"blue":"GREENHALL"==homee?"green":"empty";document.id("city").style.background="empty"==e||small_device?null:"url(/img/"+e+"_screen.jpg) center center no-repeat",function(){document.id("phones").fade(0)}.delay(500)}else{small_device&&(document.id("stats").style.visibility="hidden",document.id("stats_p").style.visibility="hidden",document.id("stats_v").style.visibility="hidden",document.id("stats_ng").style.visibility="hidden",document.id("air").style.visibility="hidden",document.id("helpdoc").style.visibility="hidden",document.id("tex").style.visibility="hidden",document.id("chess").style.visibility="hidden",document.id("want").style.visibility="hidden",document.id("logger").style.display="none"),small_device||(document.id("controls").style.display="none"),small_device&&(document.id("controls").style.visibility="hidden"),small_device&&(document.id("bg_switch").style.display="none"),document.id("streamer").style.display="none",document.id("house").style.display="block",document.id("house").style.visibility="visible",small_device&&document.id("second_logger")&&function(){document.id("second_logger").style.visibility="hidden",document.id("second_logger").style.display="block"}.delay(2e3);let e="REDHALL"==homee?"red":"BLUEHALL"==homee?"blue":"GREENHALL"==homee?"green":"empty";document.id("city").style.background="empty"!=e?"url(/img/"+e+"_screen.jpg) center center no-repeat":null,function(){document.id("phones").fade(0)}.delay(100);let t="REDHALL"==homee?small_device?24:30:"BLUEHALL"==homee?small_device?24:27:"GREENHALL"==homee&&small_device?24:33;document.id("participants").style.top="-"+t+"vh",document.id("house").style.textAlign="center"}document.id("dbao")&&(document.id("dbao").style.display="none"),a.name&&a.name.length&&(document.id("name").value=a.name,saveData("name",a.name,1440),document.id("roomName").value=roomee.length?roomee:a.room,document.id("houseName").value=w[0],role=a.role,0!=role.length?0==role&&(i_am_dummy_guest=!0):role=0,a.curip&&(document.id("curip").value=a.curip,curIP=document.id("curip").value),register(),0==role&&hack&&(role=1),0==role?(document.id("bell").addEventListener("click",signalGuru),window.addEvent("domready",(function(){mod3=new mBox.Modal({content:left_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:240,title:"Ok!",attach:"leftpluss"}),mod4=new mBox.Modal({content:right_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:240,title:"Ok!",attach:"rightpluss"})}))):1==role&&document.id("logger").addEventListener("dblclick",(function(e){if(e.preventDefault(),e.stopPropagation(),window.confirm("Make everyone leave?")){let e=getCookie("authtoken")||"";sendMessage({id:"makeLeave",name:"all",token:e})}})),document.id("room-header").addEventListener("click",(function(e){e.preventDefault(),e.stopPropagation(),toggleHeader(1)})),document.id("room-header").addEventListener("dblclick",(function(e){e.preventDefault(),e.stopPropagation(),toggleHeader(2)})),-1!=role&&sp_shown&&request("https://"+window.location.hostname+"/cgi/genc/get_acc_id.pl").then((e=>{setTimeout((function(){document.id("removerA")&&(document.id("removerA").innerHTML="Error: Service unavailable",function(){document.id("removerA").fade(0)}.delay(1e3))}),1e4),function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+e)}.delay(1e3),ch_int=setInterval((function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+e)}),3e5)})),document.id("logger").click(),function(){document.id("message_wrap").style.display="block"}.delay(1e3),function(){document.id("chatter").style.display="block",document.id("antichatter").style.display="block",document.id("audience").style.display="block"}.delay(1e3),function(){document.id("phones").style.paddingTop=small_device?"39vh":"45vh"}.delay(1e3),voting_shown||sp_shown?function(){document.id("room-header").style.marginTop=small_device?"4vw":"8vw",document.id("room-backer").style.marginTop=small_device?"14vw":"8vw",document.id("room-header").style.marginBottom=small_device?"0px":"20px",document.id("room-backer").style.marginBottom=small_device?"20px":"40px",voting_shown&&(document.id("subcontrols").style.display="block",document.id("subcontrols").fade(1))}.delay(1e3):document.id("room-header").style.marginTop=small_device?"0vw":"8vw",stats_p.setAttribute("title",now+" presenters"),stats_v.setAttribute("title",now+" guests"),stats_ng.setAttribute("title",today)),document.id("phones").onclick="",document.id("phones").style.cursor="none",cine||document.id("container").fade(1)};let s=getCookie("name");if(null!=s&&"null"!=s){if(document.id("loading_span")&&document.id("loading_span").fade(0),r(),0==role){let e=checkLang();flashText(du_.get(altlang[e]),3e3)}}else{normal_mode=!1;sp_shown=0,document.id("main_container").style.marginTop=small_device?document.id("main_container").style.marginTop:"16vh",setCookie("new_cache",!0,14400);let t={id:"checkRoom",room:homee,tok:""};sendMessage(t),document.id("loading_span")&&document.id("loading_span").fade(0),document.id("join").style.visibility="hidden",document.id("langs").style.visibility="hidden",document.id("house").style.visibility="hidden",function(){if(document.id("phones").style.cursor="pointer",document.id("phones").style.paddingTop="0vh",document.id("phones").style.display="block",document.id("phones").fade(1),document.id("phones").onclick=function(){w[0]==homee?e():r()},document.id("loading_span")&&(document.id("loading_span").style.display="none"),!cine){let e=checkLang();document.id("ph_b").style.background="#112",document.id("ph_b").innerHTML='<div id="locked_w" style="margin-top:20%;">'+lo_.get(altlang[e])+"</div>",function(){document.id("locked_w").fade(0),function(){location.reload()}.delay(500)}.delay(2e3)}document.id("ph_b")&&(document.id("ph_b").style.visibility="visible"),console.log("here we are! role is",role)}.delay(500)}document.id("preco").style.height="0px",document.id("main_container").style.height="0px",document.id("room").style.height="0px",document.id("room-header_box").style.height="0px",document.id("room").style.marginTop="-57vh"}else if(e.origin==sm_url){"close_iframe"==(a=JSON.parse(e.data)).action&&document.id("sm_niche")&&(document.id("sm_niche").fade(0),document.id("sm_niche").style.zIndex="-10100",document.id("sm_niche").style.display="none",document.id("sm_niche").src="")}else if("https://room-house.com"==e.origin||e.origin==poker_url){"close_iframe"==(a=JSON.parse(e.data)).action&&document.id("poker_niche")&&(document.id("poker_niche").fade(0),document.id("poker_niche").style.zIndex="-10100",document.id("poker_niche").style.display="none",document.id("poker_niche").src="")}else if(e.origin==chess_url){"close_iframe"==(a=JSON.parse(e.data)).action&&document.id("chess_niche")&&(document.id("chess_niche").fade(0),document.id("chess_niche").style.zIndex="-10100",document.id("chess_niche").style.display="none",document.id("chess_niche").src="")}else if(e.origin==air_url){"close_iframe"==(a=JSON.parse(e.data)).action&&document.id("air_niche")&&(document.id("air_niche").fade(0),document.id("air_niche").style.zIndex="-10100",document.id("air_niche").style.display="none",document.id("air_niche").src="")}else if(e.origin==swap_url){"close_iframe"==(a=JSON.parse(e.data)).action&&document.id("swap_niche")&&(document.id("swap_niche").fade(0),document.id("swap_niche").style.zIndex="-10100",document.id("swap_niche").style.display="none",document.id("swap_niche").src="")}else if(e.origin==sp_setter_url){if("Bound"==(a=JSON.parse(e.data)).action){(function(){document.id("m6")&&(document.id("m6").style.display="none",document.id("m6").dispose(),[...document.querySelectorAll("[style*='z-index: 31004']")].forEach((e=>e.dispose())))}).delay(1e3),document.id("sp_balance").src=sp_container_url+"/?acc="+a.from,clearInterval(ch_int),ch_int=setInterval((function(){document.id("sp_balance")&&(document.id("sp_balance").style.display="block",document.id("sp_balance").src=sp_container_url+"/?acc="+a.from)}),3e5),afterBinding=!0;let e=document.querySelector("video");setTimeout((function(){e.click()}),500)}else console.log("Undefined action received from wallet!")}else{var a;if("saveCookie"==(a=JSON.parse(e.data)).action)doSwitchOneMode(document.id("newacc"),"5ENzTTUL3zvnMP8usRo3ZcGmMhkaHsvFUP6PMedLV9EWtLFx",.5);else if("openWallet"==a.action)window.open("https://wallet.room-house.com","_blank");else if("load"==a.action){if(document.id("removerA")&&document.id("removerA").remove(),document.id("sp_container")&&sp_shown){var r=function(){this.start({marginTop:-24})};window.addEvent("domready",(function(){var e=document.id("controls"),t=new Fx.Morph(e,{fps:15});document.id("slidein").addEvent("click",r.bind(t))})),document.id("sp_container").style.display="block",document.id("slidein").click()}document.id("demo_info")&&(document.id("demo_info").style.display="block")}else if("err"==a.action)document.id("removerA")&&document.id("removerA").remove(),function(){document.id("sp_container")&&sp_shown&&(document.id("sp_container").style.display="none"),document.id("poll_container").style.display="none"}.delay(1e3);else if("success"==a.action&&(document.id("removerB")&&document.id("removerB").remove(),document.id("sp_container")&&sp_shown&&"block"==document.id("sp_container").style.display)){document.querySelectorAll(".accos").forEach((e=>{e.style.visibility="visible"}))}}return!1}})),window.addEvent("domready",(function(){mod1=new mBox.Modal({content:about_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:28,margin:"0 auto",fontSize:24}},width:300,title:"About R-H",attach:"abouter"}),mod2=new mBox.Modal({content:help_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:28,margin:"0 auto",fontSize:24}},width:300,title:"Help",attach:"helper"}),mod5=new mBox.Modal({content:central_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:210,title:"Ok!",attach:"chatter"}),mod7=new mBox.Modal({content:anno_adder_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:210,title:"Set Annotation",attach:"anno_adder"}),mod8=new mBox.Modal({content:stream_adder_content.get(altlang[ctr]),setStyles:{content:{padding:"25px",lineHeight:24,margin:"0 auto",fontSize:18,color:"#222"}},width:210,title:"Stream M3U8",attach:"stream_adder"}),function(){document.id("wrapper").fade(1)}.delay(200),function(){document.id("preroom").fade(1)}.delay(100),oldColor=document.id("room-header")?document.id("room-header").style.color:"",setInterval((function(){document.id("message_box")&&document.id("message_wrap")&&"block"==document.id("message_wrap").style.display&&chat_shown&&ajax_chat()}),3e3)}));const gifr=e=>{if(document.getElementsByTagName("iframe")[7]&&"ifrr"==document.getElementsByTagName("iframe")[7].name){let t=document.getElementsByTagName("iframe")[7];t.id=e||"ifr",t.src="/testl.html"}else{let t=document.createElement("iframe");t.id=e||"ifr",t.name="ifrr",t.style.position="absolute",t.style.left=0,t.style.top=0,t.style.width="320px",t.style.height="240px",t.src="/testl.html",document.body.appendChild(t)}},cli1=()=>{document.id("dummy_p")&&dummies&&(document.id("dummy_p").style.display="none"),document.id("dummy2_p")&&dummies&&(document.id("dummy2_p").style.display="none"),snd_clicked||(soundEffect.src="data:audio/mpeg;base64,SUQzBAAAAAABEVRYWFgAAAAtAAADY29tbWVudABCaWdTb3VuZEJhbmsuY29tIC8gTGFTb25vdGhlcXVlLm9yZwBURU5DAAAAHQAAA1N3aXRjaCBQbHVzIMKpIE5DSCBTb2Z0d2FyZQBUSVQyAAAABgAAAzIyMzUAVFNTRQAAAA8AAANMYXZmNTcuODMuMTAwAAAAAAAAAAAAAAD/80DEAAAAA0gAAAAATEFNRTMuMTAwVVVVVVVVVVVVVUxBTUUzLjEwMFVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQsRbAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVf/zQMSkAAADSAAAAABVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVVV",snd_clicked=!0)},cli2=()=>{let e=window.innerWidth>1024?"7":"";fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t;pcounter<room_limit&&(hack=!0),0==n&&hack&&(n=1),cammode&&2!=cammode||playSomeMusic||shareSomeScreen?playSomeMusic||shareSomeScreen?flashText(playSomeMusic?"PLAYING VIDEO! STOP?":"SHARING SCREEN! STOP?"):(cammode=0,document.id("fcam").className="bigO fcam",setCookie("av",!1,144e3),aonly=1,flashText_and_rejoin("AUDIO-ONLY"),setCookie("player","")):1==n||2==n||temporary?(cammode=1,setCookie("fmode",0,144e3),setCookie("av",!0,144e3),aonly=0,document.id("av_toggler").className="bigO av_toggler_f",document.id("fcam").className="bigO fcam_f",document.id("bcam").className="bigO bcam",flashText_and_rejoin("FRONT CAM!")):(flashText(caller+'&nbsp;<img style="margin-top:-72px;" src=/icons/bell'+e+"2.png>"),document.id("fcam").className="bigO fcam")})).catch((e=>console.log(e)))},cli3=()=>{let e=window.innerWidth>1024?"7":"";fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t;(pcounter<room_limit||pcounter==room_limit&&!i_am_viewer)&&(hack=!0),0==n&&hack&&(n=1),cammode&&1!=cammode||playSomeMusic||shareSomeScreen?playSomeMusic||shareSomeScreen?flashText(playSomeMusic?"PLAYING VIDEO! STOP?":"SHARING SCREEN! STOP?"):(cammode=0,document.id("bcam").className="bigO bcam",setCookie("av",!1,144e3),aonly=1,flashText_and_rejoin("AUDIO-ONLY"),setCookie("player","")):1==n||2==n||temporary?(cammode=2,setCookie("fmode",1,144e3),setCookie("av",!0,144e3),aonly=0,document.id("av_toggler").className="bigO av_toggler_f",document.id("fcam").className="bigO fcam",document.id("bcam").className="bigO bcam_f",flashText_and_rejoin("BACK CAM!")):(flashText(caller+'&nbsp;<img style="margin-top:-72px;" src=/icons/bell'+e+"2.png>"),document.id("bcam").className="bigO bcam")})).catch((e=>console.log(e)))},cli4=()=>{playSomeMusic||shareSomeScreen?i_am_muted=!i_am_muted:toggleAllMuted()},cli5=()=>{window.innerWidth;document.id("message_box").style.display="block",document.id("audience_box").style.display="none",new_message=0,chat_shown?(document.id("message_wrap").fade(0),document.id("chatter").fade(0),document.id("audience").fade(0),document.id("antichatter").fade(0),chat_shown=0,document.id("logger").className="bigO logger"):(small_device||(document.id("message_wrap").style.top="-5vh"),(small_device||notebook)&&(document.id("message_wrap").style.top="-10vh"),document.id("chatter").style.display="block",document.id("antichatter").style.display="block",document.id("audience").style.display="block",document.id("message_wrap").fade(1),document.id("chatter").fade(1),document.id("audience").fade(1),document.id("antichatter").fade(1),chat_shown=1,document.id("logger").className="bigO logger_f",voting_shown&&function(){document.id("subcontrols").style.display="block",function(){document.id("ball1")&&function(){document.id("ball1").fade(0),document.id("leftlab").fade(1)}.delay(2e3),document.id("ball2")&&function(){document.id("ball2").fade(0),document.id("rightlab").fade(1)}.delay(2e3),function(){document.id("leftplus").innerHTML="+",document.id("rightplus").innerHTML="+"}.delay(2e3)}.delay(2e3),document.id("subcontrols").fade(1)}.delay(500))},cli6=()=>{let e=window.innerWidth>1024?"7":"";fetch("https://"+window.location.hostname+port+"/cgi/genc/checker.pl",{credentials:"include"}).then((e=>e.text())).then((t=>{let n=t;if(pcounter<room_limit&&(hack=!0),0==n&&hack&&(n=1),aonly)already_being_played=0,document.id("room-header").style.color=oldColor,document.id("room-header-file").style.display="none",document.id("av_toggler").className="bigO av_toggler_f",1==n||2==n||temporary?(setCookie("av",!0,144e3),aonly=0,flashText_and_rejoin("VIDEO ON!")):(flashText(caller+'<img style="&nbsp;margin-top:-72px;" src=/icons/bell'+e+"2.png>"),document.id("av_toggler").className="bigO av_toggler");else{if(playSomeMusic)if(shareSomeStream)document.getElementsByTagName("iframe")[7]&&"ifrr"==document.getElementsByTagName("iframe")[7].name&&document.getElementsByTagName("iframe")[7].dispose();else{let e="video-"+document.id("name").value;document.id(e)&&setCookie("cT_"+curMoviesList[0],document.id(e).currentTime,14400)}cammode=0,playSomeMusic=!1,shareSomeScreen=!1,shareSomeStream=!1,g.audioContext=null,document.id("av_toggler").style.color="#777",setCookie("av",!1,144e3),setCookie("fmode",null,0),aonly=1,flashText_and_rejoin("AUDIO-ONLY"),setCookie("player","")}})).catch((e=>console.log(e)))},cli7=()=>{window.innerWidth;document.id("message_wrap").fade(0),document.id("chatter").fade(0),document.id("audience").fade(0),document.id("antichatter").fade(0),chat_shown=0,document.id("logger").className="bigO logger"},cli8=()=>{homee=document.id("roomName").value!==w[0]&&homee===w[0]?document.id("roomName").value:homee,fetch("https://"+window.location.hostname+port+"/cgi/genc/get_guests.pl?room="+homee,{credentials:"include"}).then((function(e){200===e.status?e.json().then((function(e){if(0!=e){let t="";Object.keys(e).map((t=>e[t])).forEach((e=>{let n=e[0].split("_")[0],o=e[3].split(" ")[1].split(":"),i=o[0]+":"+o[1];t=t+"<div><span>"+n+"</span>,&nbsp;<span>"+e[1]+"</span>,&nbsp;<span>"+e[2]+"</span>&nbsp;<span>"+i+"</span></div>"})),t+='<div style="line-height:60px;">&nbsp;</div>',document.id("logger").click(),chat_shown=0,document.id("message_box").innerHTML=t,document.id("message_box").fade(1)}})):console.log("Status Code: "+e.status)})).catch((e=>console.log(e)))};
